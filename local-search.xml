<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Fixed the broken search in nextjs-notion-starter-kit</title>
    <link href="/2023/10/17/Fixed%20the%20broken%20search%20in%20nextjs-notion-starter-kit/"/>
    <url>/2023/10/17/Fixed%20the%20broken%20search%20in%20nextjs-notion-starter-kit/</url>
    
    <content type="html"><![CDATA[<blockquote><p>Last Update: Finally, Iâ€™ve decided to abandon the Next.js Notion starter kit for my website. Instead, I recommend trying out the solution of Notion + Elog + Hexo. It allows for easy DIY and offers better page speed. Iâ€™ll write an article to introduce it next time!</p></blockquote><h2 id="Reputation"><a href="#Reputation" class="headerlink" title="Reputation"></a>Reputation</h2><p>Thanks to @<strong>Travis Fischer</strong> for bringing us this awesome project that combines Next.js and Notion. It makes building a custom website quite simple.</p><h2 id="Reason"><a href="#Reason" class="headerlink" title="Reason"></a>Reason</h2><p>If your <a href="https://github.com/transitive-bullshit/nextjs-notion-starter-kit"><code>nextjs-notion-starter-kit</code></a> version is <strong>v2.0.0</strong> or below, like my project is <strong>v2.0.0</strong>, youâ€™ll find your search function is broken. This is because of <strong>the search API params was changed by Notion</strong>.</p><blockquote><p>ğŸ’¡  As the pic shows, param <strong>sort</strong> turned <code>String</code> into an <code>Object</code>.</p></blockquote><p><img src="https://cdn.danni.cool/file/8b232e71595cf51a7fb21bfca5717fa2.png" alt="Untitled.png"></p><p>Although the guy @Armster15 fixed this problem in the Projectâ€™s dependency <a href="https://github.com/NotionX/react-notion-x/compare/v6.16.0...v6.16.1"><code>react-notion-x@6.16.1</code></a> , but the <a href="https://www.npmjs.com/package/notion-client">npm version</a> is still v6.16.0 until 17&#x2F;10&#x2F;2023.</p><h2 id="Solve"><a href="#Solve" class="headerlink" title="Solve"></a>Solve</h2><p>We can not simply update the dependency version to solve this problem,  I believe the author will fixed the issue in the future. but currently we need a hotfix. The way is quite simple:</p><p>1.find a package called <code>patch-package</code> in npm, and install it.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">//npm <br>npm i patch-package --legacy-peer-deps<br><br>//yarn<br>yarn add patch-package<br></code></pre></td></tr></table></figure><p>2.add a post-install hook in <code>package.json</code>, like this</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;nextjs-notion-starter-kit&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.0.0&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;private&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;The perfect starter kit for building beautiful websites with Next.js and Notion.&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Travis Fischer &lt;travis@transitivebullsh.it&gt;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;repository&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;transitive-bullshit/nextjs-notion-starter-kit&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;license&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;MIT&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;engines&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;node&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&gt;=16&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;postinstall&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;patch-package&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// &lt;== look here, add this one only.</span><br>    <span class="hljs-attr">&quot;dev&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;next dev&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;next build&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;next start&quot;</span><span class="hljs-punctuation">,</span><br></code></pre></td></tr></table></figure><p>3.download the patch file and put it into your project dir <code>/patches</code> , as the pic shows.</p><h3 id="Download-The-Patch-File"><a href="#Download-The-Patch-File" class="headerlink" title="Download The Patch File"></a>Download The Patch File</h3><blockquote><p>File on Google Drive<br><a href="https://drive.google.com/file/d/17AQFkbqJVH53DGIKYGZBHGTH1w6Rgpzu/view">file</a></p></blockquote><pre><code class="hljs">[file](https://drive.google.com/file/d/17AQFkbqJVH53DGIKYGZBHGTH1w6Rgpzu/view)</code></pre><p><img src="https://cdn.danni.cool/file/f4223b235e88ff84868b2d931cdd71bc.png" alt="Untitled.png"></p><p>4.Run <code>npm i --legacy-peer-deps</code> again**,** the patches will apply to the <code>node_modules</code>.</p><p>5.Test the your project in development, it works.</p><p><img src="https://cdn.danni.cool/file/f49eb72349e81f6e06d1a21fb02c1db5.png" alt="Untitled.png"></p>]]></content>
    
    
    <categories>
      
      <category>Tech</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Next.js</tag>
      
      <tag>Notion</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>A Simple Install Test Between Npm, Yarn and Pnpm</title>
    <link href="/2023/10/15/A%20Simple%20Install%20Test%20Between%20Npm,%20Yarn%20and%20Pnpm/"/>
    <url>/2023/10/15/A%20Simple%20Install%20Test%20Between%20Npm,%20Yarn%20and%20Pnpm/</url>
    
    <content type="html"><![CDATA[<p>Iâ€™m working on my new open-source project <a href="https://github.com/danni-cool/docker-wechatbot-webhook"><strong>docker-wechatbot-webhook</strong></a> recently, itâ€™s a Node.js app that allows you to easily send messages  to <a href="https://www.wechat.com/en/">Wechat</a> through http requests. </p><h1 id="A-Discussion-Of-Dockerfile"><a href="#A-Discussion-Of-Dockerfile" class="headerlink" title="A Discussion Of Dockerfile"></a>A Discussion Of Dockerfile</h1><p>Three months ago, my friend J were discussed with me about this projectâ€™s dockerfile. He thought the <code>npm install</code> layer may slowed down the dockerâ€™s build speed in Github Actions.</p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs docker"><span class="hljs-keyword">FROM</span> node:<span class="hljs-number">18</span>-alpine<br><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span><br><br><span class="hljs-keyword">COPY</span><span class="language-bash"> package*.json ./</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> npm install</span><br></code></pre></td></tr></table></figure><p><strong>J</strong>ï¼š<em>â€œDaniel, Itâ€™s 2023, why are you still using the broken slow npm to install the node_modules, itâ€™s the time of pnpm â€” faster and smallerâ€.</em> </p><p><strong>Me:</strong> <em>â€œwell, Iâ€™ve heard this before, so letâ€™s try itâ€.</em></p><p>And for the principle of â€œ<strong>talk is cheap, show me the PR</strong>â€, he helped to optimize the dockerfile finally.ğŸ˜‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">FROM node:18-alpine<br><br>WORKDIR /app<br><br>COPY package.json pnpm-lock.yaml ./<br><br>RUN npm install -g pnpm &amp;&amp; pnpm install &amp;&amp; pnpm store prune &amp;&amp; npm uninstall pnpm -g<br></code></pre></td></tr></table></figure><h1 id="Pnpm-Improves-Nothing"><a href="#Pnpm-Improves-Nothing" class="headerlink" title="Pnpm Improves Nothing?"></a>Pnpm Improves Nothing?</h1><p><img src="https://cdn.danni.cool/file/7b31bc2ab1890888ba0a53199fafe44b.png" alt="Untitled.png"></p><p>We know, pnpm <strong>uses symbol links point to a global space to resolve the node_modules  in every project</strong>, <strong>so that each project installs modules only once in specific version, thatâ€™s one of the advantages why pnpm takes little space and install node_modules so quick.</strong></p><p>With the high expectation of pnpmâ€™s magic, I found the docker build speed is almost unchanged in Github Actions. ğŸ¤¨</p><p><img src="https://cdn.danni.cool/file/21ce41b0678696e994551a72f63a4409.jpg" alt="Jietu20231206-154642.jpg"></p><p>Why was that? In Github Runner, each building task owns a new environment. it means whether to choose npm , yarn or pnpm , they all need to reinstall again. </p><h1 id="Github-Actions-Cache"><a href="#Github-Actions-Cache" class="headerlink" title="Github Actions Cache"></a>Github Actions Cache</h1><p>If you install node_modules in Github Actions workflow, there comes a way to cache dependencies and build outputs ğŸ‘‰ <a href="https://github.com/actions/cache">https://github.com/actions/cache</a>.</p><p>What my workflow does is to build dockerfile, upload to dockerHub, and then push a release PR. The <code>npm install</code> step is only running in docker building progress. So this cache method is helpless.</p><p>Docker actually support DLC (docker layer caching) , but Github Actions donâ€™t support it in native. </p><p>You can still rely on some third party service to cache layer, however, it makes this node app more complex. itâ€™s not necessary right now.</p><p>At least, it claims that I donâ€™t need to alternate it from npm to pnpm at current stage, I know itâ€™s not pnpm â€™s fault. one of the reasons is my app is not too much complex, I believed it can speed up my works in local dev.</p><h1 id="Performance-In-Local-Dev"><a href="#Performance-In-Local-Dev" class="headerlink" title="Performance In Local Dev"></a>Performance In Local Dev</h1><p>I had tested the performance between these 3 package managers in development. built them in 3 different conditions separately for comparing the installation size and time.</p><ol><li>install modules with no cache and no lock file.</li><li>install modules with no cache but with lock file.</li><li>clear cache and remove package manager after building finished.</li></ol><table><thead><tr><th>pkg manager</th><th>no cache and no lock file</th><th>no cache but with lock File</th><th>clear cache and remove pkg manager</th><th>clear cache command</th><th>problem after remove cache</th></tr></thead><tbody><tr><td><strong>npm</strong></td><td>669 MB &#x2F; 74.3s</td><td>655.2MB &#x2F; 36.3s</td><td>568.41MB</td><td><em>npm</em> <em>cache</em> <em>clean</em> <em>â€“force</em></td><td></td></tr><tr><td><strong>yarn</strong></td><td>616MB &#x2F; 59.7s</td><td>616MB &#x2F; 36s</td><td>467.75MB</td><td>yarn cache clean</td><td></td></tr><tr><td><strong>pnpm</strong></td><td>732 MB &#x2F; 42.5s</td><td>701.67MB &#x2F; 36.5s</td><td>566.63MB</td><td><em>pnpm</em> <em>store</em> <em>prune</em></td><td>Error: Cannot find module â€˜file-boxâ€™</td></tr></tbody></table><h3 id="No-cache-and-no-lock-file"><a href="#No-cache-and-no-lock-file" class="headerlink" title="No cache and no lock file"></a>N<strong>o cache and no lock file</strong></h3><p>just like the scene that we init a new project, pnpm is far ahead in installation time than yarn about <strong>40.47%,</strong>  npm about <strong>74.82%,</strong> itâ€™s a incredible score! But yarn has the minimal installation size, pnpm is at the bottom.</p><h3 id="No-cache-but-with-lock-file"><a href="#No-cache-but-with-lock-file" class="headerlink" title="No cache but with lock file"></a>No cache but with lock file</h3><p>like the most common build scene, the installation time is roughly similar, but the size is still minimal via yarn installed, pnpm is at the bottom</p><h3 id="Clear-cache-and-remove-package-manage"><a href="#Clear-cache-and-remove-package-manage" class="headerlink" title="Clear cache and remove package manage"></a>Clear cache and remove package manage</h3><p><strong>yarn</strong> is ahead over others in installation size, however, the node_modules that installed via pnpm comes an error when I try to launch my project. but I found it was my fault after I carefully debug the reason. </p><p>I was tried to import the module called â€œ<strong>file-boxâ€</strong> which is not declared in the package.json**.** Actually, itâ€™s a dependency of <a href="https://github.com/wechaty/wechaty"><strong>Wechaty</strong></a>. </p><p><img src="https://cdn.danni.cool/file/18a602bd544140a79ea214530bb70ce9.png" alt="Untitled.png"></p><p><strong>Pnpm helped me find an potential issues, it called â€œ</strong><a href="https://broadcrunch.com/technology/computing/phantom-dependencies-in-nodejs-and-how-pnpm-prevents-them/"><strong>phantom dependencies</strong></a><strong>â€.</strong></p><p>Phantom dependencies is dangerous because it will cause error or crash if â€œWechatyâ€ donâ€™t depends â€œfile-boxâ€ anymore. Although it runs well in local dev.</p><h1 id="Final-Thoughts"><a href="#Final-Thoughts" class="headerlink" title="Final Thoughts"></a><strong>Final Thoughts</strong></h1><ol><li>Use <code>pnpm</code> in most scenarios because it offers faster installation speeds, uses less disk space cross multiple projects, it helps prevent potential issues.</li><li>Use <code>yarn</code> if you wanna have a minimal app size,  like Docker image or other one-time build package.</li></ol>]]></content>
    
    
    <categories>
      
      <category>Tech</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Yarn</tag>
      
      <tag>Pnpm</tag>
      
      <tag>Github Actions</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸºäºå¤šé¡µé¡¹ç›®çš„å¾®å‰ç«¯æ”¹é€ </title>
    <link href="/2021/09/09/%E5%9F%BA%E4%BA%8E%E5%A4%9A%E9%A1%B5%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%BE%AE%E5%89%8D%E7%AB%AF%E6%94%B9%E9%80%A0/"/>
    <url>/2021/09/09/%E5%9F%BA%E4%BA%8E%E5%A4%9A%E9%A1%B5%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%BE%AE%E5%89%8D%E7%AB%AF%E6%94%B9%E9%80%A0/</url>
    
    <content type="html"><![CDATA[<p>Techniques, strategies and recipes for building a modern web app with multiple teams using different JavaScript frameworks.â€”â€” Micro Frontends</p><p>ä¸€ç§å¯ä»¥è®©å¤šä¸ªå›¢é˜Ÿä½¿ç”¨ä¸åŒJavaScriptæ¡†æ¶çš„æŠ€æœ¯ã€ç­–ç•¥å’Œæ–¹æ³• â€”â€” å¾®å‰ç«¯</p><h1 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h1><p>ä¸é¦™äººæ‰è¿è¥ç®¡ç†åå°æ˜¯ä¸€ä¸ªé¢å‘è¿è¥ä½¿ç”¨çš„åå°ç®¡ç†ç³»ç»Ÿï¼Œæ–¹ä¾¿è¿è¥åœ¨åå°å»é…ç½®ä¸€äº›è¿è¥æ´»åŠ¨ä»è€Œå‡å°‘å¼€å‘æ‰‹åŠ¨å†™ä»£ç å»é…ç½®åŠŸèƒ½çš„é—®é¢˜ã€‚ç®¡ç†åå°çš„å‰ç«¯æŠ€æœ¯æ¶æ„æ˜¯ä¸€ä¸ªåŸºäºvueå…¨å®¶æ¡¶çš„å¤šé¡µåº”ç”¨ï¼Œé‡æ„å‰æœ‰33 ä¸ªç‹¬ç«‹å…¥å£é¡µé¢ï¼Œå¹¶æœªåšç›¸å…³æ•´åˆã€‚</p><p>ç”±äºé¡µé¢ä¹‹é—´çš„äº’ç›¸è·³è½¬ï¼Œåº”ç”¨ä¹‹é—´åˆ‡æ¢é€ æˆäº†æµè§ˆå™¨é‡åˆ·ï¼Œè¿è¥åœ¨æµç¨‹æ“ä½œä¸Šå­˜åœ¨æ–­ç‚¹ã€‚åŒæ—¶äº§å“ä¹Ÿå¸Œæœ›æƒ³å°†è¦åŸå…ˆåˆ†æ•£åœ¨ä¸åŒå…¥å£ä¹‹é—´çš„åº”ç”¨æ•´åˆåˆ°ä¸€ä¸ªé¡µé¢ï¼Œç›®å‰è¿˜å­˜åœ¨å¤šç§ä¸åŒç»„åˆçš„æƒ…å†µã€‚</p><p>å¦‚æœæ¯ä¸ªå…¥å£éƒ½å¢åŠ ä¸€ä¸ªä¾§è¾¹æ ç»„ä»¶ï¼Œå¼€å‘æˆæœ¬å°±æ˜¯N * repeatã€‚è€ŒåŸºäºåŸå…ˆçš„å¤šé¡µåº”ç”¨ï¼Œä½¿ç”¨å¾®å‰ç«¯çš„æ¶æ„å¯ä»¥å¹³æ»‘è¿‡æ¸¡ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šäº§ç”Ÿä¾§è¾¹æ ä»£ç ä¸€å¼å¤šä»½çš„é—®é¢˜ã€‚å€Ÿç€è¿™ä¸ªæœºä¼šæˆ‘åœ¨å¾®å‰ç«¯åšå‡ºäº†ä¸€äº›æ¢ç´¢ã€‚</p><h1 id="äºŒã€å½“å‰çš„ç—›ç‚¹"><a href="#äºŒã€å½“å‰çš„ç—›ç‚¹" class="headerlink" title="äºŒã€å½“å‰çš„ç—›ç‚¹"></a>äºŒã€å½“å‰çš„ç—›ç‚¹</h1><ol><li><strong>å®¢æˆ· or äº§å“éœ€æ±‚ï¼ˆå®šåˆ¶åŒ–ï¼‰</strong></li><li>ç”±äºäº§å“ä¹‹é—´ç›¸äº’è·³è½¬ï¼Œåº”ç”¨ä¹‹é—´åˆ‡æ¢ä¼šé€ æˆæµè§ˆå™¨é‡åˆ·ï¼Œæµç¨‹ä½“éªŒä¸Šä¼šå­˜åœ¨æ–­ç‚¹,è¿™ä¹Ÿæ˜¯è¿è¥å’Œäº§å“ä¸Šçš„ç—›ç‚¹Â âœ…</li><li>æ¯ä¸ªåŠŸèƒ½æ¨¡å—æ¯”è¾ƒç‹¬ç«‹ã€æœ‰ç‰¹è‰²ã€‚å¦‚æœè¯´å°†æ¥éœ€è¦æ‹†åˆ†ç»„æˆä¸€ä¸ªå¤§å•é¡µçš„è¯ï¼Œæ‹†åˆ†+ç»„åˆå·¥ä½œé‡å¤§ï¼ŒåæœŸtabèœå•å†æ•´åˆçš„æ—¶å€™è¿˜éœ€è¦ç»§ç»­æ‹†åˆ†+ç»„åˆã€‚Â âœ…</li><li><strong>å¼€å‘&amp;è¿ç»´æˆæœ¬</strong></li><li>æ¯æ¬¡å¼€å‘ä¸€ä¸ªæ–°æ¨¡å—éƒ½éœ€è¦å‘åç«¯æä¾›ä¸€ä¸ªæ–°å…¥å£æ–‡ä»¶ï¼Œåç«¯å‘ŠçŸ¥å‰ç«¯è·¯ç”±åœ°å€ï¼Œæ–°æ¨¡å—éƒ¨ç½²æˆæœ¬ã€‚ âœ…</li><li>ï¼ˆæœªæ¥ï¼‰<del>å¤šäººåˆä½œå¼€å‘åŒä¸€ç§äº§å“ï¼Œä½†ç°æœ‰å‘å¸ƒçš„è€¦åˆæ€§é™ä½äº†äº¤ä»˜æ•ˆç‡</del>Â âœ…</li><li><strong>å¤šé¡µåº”ç”¨ï¼ˆmulti-page applicationï¼‰çš„é—®é¢˜</strong></li><li>ä½¿ç”¨å¤šé¡µåº”ç”¨çš„æ–¹å¼å»æ­å»ºåå°äº§å“ï¼Œéšç€åº”ç”¨çš„å¤æ‚åº¦çš„æå‡ï¼Œä»£ç çš„æ„å»ºå˜å¾—è¶Šæ¥è¶Šæ…¢Â âœ…</li><li>å…¬å…±èµ„æºæ— æ³•å¤ç”¨ï¼Œé¡µé¢åˆ·æ–°æ—¶ï¼Œé™æ€èµ„æºéœ€è¦åå¤åŠ è½½ï¼Œé™ä½äº†äº¤äº’ä½“éªŒÂ âœ…</li><li>å¤šä¸ªé¡µé¢çŠ¶æ€å…±äº«å˜å¾—å¾ˆå›°éš¾Â âœ…</li></ol><p><strong>ç›¸å¯¹æ¯”SPAï¼š</strong></p><p>SPA åˆ™å¤©ç”Ÿå…·å¤‡ä½“éªŒä¸Šçš„ä¼˜åŠ¿ï¼Œåº”ç”¨ç›´æ¥æ— åˆ·æ–°åˆ‡æ¢ï¼Œèƒ½æå¤§çš„ä¿è¯å¤šäº§å“ä¹‹é—´æµç¨‹æ“ä½œä¸²è”æ—¶çš„æµç¨‹æ€§ã€‚ç¼ºç‚¹åˆ™åœ¨äºå„åº”ç”¨æŠ€æœ¯æ ˆä¹‹é—´æ˜¯å¼ºè€¦åˆçš„ã€‚</p><p>æ‰€ä»¥æœ‰æ²¡æœ‰ä¸€ç§åŠæ³•æ—¢å¯ä»¥ä¿è¯æ‹¥æœ‰å•é¡µåº”ç”¨çš„ä½“éªŒï¼Œåˆå¯ä»¥å…¼å®¹å¤šä¸ªæŠ€æœ¯æˆ˜çš„å…¼å®¹å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯å¾®å‰ç«¯ã€‚</p><h1 id="ä¸‰ã€å¾®å‰ç«¯æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ä¸‰ã€å¾®å‰ç«¯æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä¸‰ã€å¾®å‰ç«¯æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ä¸‰ã€å¾®å‰ç«¯æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>å¾®å‰ç«¯æ˜¯ä¸€ç§æ–°æ¶æ„é£æ ¼ï¼Œæœ€æ—©ç”±Â ThoughtWorks äº2016å¹´æå‡ºï¼Œå°†åç«¯å¾®æœåŠ¡çš„ç†å¿µåº”ç”¨äºæµè§ˆå™¨ç«¯ï¼Œå³å°† Web åº”ç”¨<strong>ç”±å•ä¸€çš„å•ä½“åº”ç”¨è½¬å˜ä¸ºå¤šä¸ªå°å‹å‰ç«¯åº”ç”¨èšåˆä¸ºä¸€</strong>çš„åº”ç”¨ã€‚ å…¶ä¸­ä¼—å¤šç‹¬ç«‹äº¤ä»˜çš„å‰ç«¯åº”ç”¨ç»„åˆæˆä¸€ä¸ªå¤§å‹æ•´ä½“ã€‚</p><p><img src="https://cdn.danni.cool/file/80cdb43d9e6255002a0d5341af1b730c.png" alt="1572839045880-4d255d03-31b2-4f5a-9d68-c501954c8217.png"></p><p>åœ¨ ThoughtWorks æ­£å¼å‘å¸ƒçš„æœ€æ–°ä¸€æœŸï¼ˆ2019å¹´4æœˆï¼‰<a href="https://www.thoughtworks.com/cn/radar">æŠ€æœ¯é›·è¾¾</a>ä¸­ï¼Œå¾®å‰ç«¯å·²ç»è¿›å…¥åˆ°<strong>é‡‡çº³</strong>ï¼ˆadoptï¼‰é˜¶æ®µï¼Œè€Œä¸”å®ƒ<strong>å¼ºçƒˆæ¨è</strong>æˆ‘ä»¬åœ¨åˆé€‚çš„é¡¹ç›®ä¸­åº”è¯¥ä½¿ç”¨è¿™ä¸ªæ–¹æ¡ˆã€‚</p><p><img src="https://cdn.danni.cool/file/b77d9bd2eba157bf88929d9acdf83350.png" alt="1572759229607-09c5e615-1f16-4b1a-ba68-e9eea382669c.png"></p><h1 id="å››ã€å¾®å‰ç«¯çš„ä»·å€¼"><a href="#å››ã€å¾®å‰ç«¯çš„ä»·å€¼" class="headerlink" title="å››ã€å¾®å‰ç«¯çš„ä»·å€¼"></a>å››ã€å¾®å‰ç«¯çš„ä»·å€¼</h1><p>å¾®å‰ç«¯æ¶æ„æ—¨åœ¨è§£å†³å•ä½“åº”ç”¨åœ¨ä¸€ä¸ªç›¸å¯¹é•¿çš„æ—¶é—´è·¨åº¦ä¸‹ï¼Œç”±äºå‚ä¸çš„äººå‘˜ã€å›¢é˜Ÿçš„å¢å¤šã€å˜è¿ï¼Œä»ä¸€ä¸ªæ™®é€šåº”ç”¨æ¼”å˜æˆä¸€ä¸ª<strong>å·¨çŸ³åº”ç”¨</strong>( Frontend Monolith )åï¼Œéšä¹‹è€Œæ¥çš„åº”ç”¨ä¸å¯ç»´æŠ¤çš„é—®é¢˜ã€‚è¿™ç±»é—®é¢˜åœ¨ä¼ä¸šçº§ Web åº”ç”¨ä¸­å°¤å…¶å¸¸è§ã€‚</p><ul><li><strong>æŠ€æœ¯é€‰å‹çµæ´»</strong>ï¼šä¸»æ¡†æ¶ä¸é™åˆ¶æ¥å…¥åº”ç”¨çš„æŠ€æœ¯æ ˆï¼Œå¯ä»¥ä½¿ç”¨å¸‚é¢ä¸Šæ‰€æœ‰çš„å‰ç«¯æŠ€æœ¯æ ˆå­åº”ç”¨å…·å¤‡å®Œå…¨è‡ªä¸»æƒ</li><li><strong>ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹éƒ¨ç½²</strong>ï¼šå­åº”ç”¨ä»“åº“ç‹¬ç«‹ï¼Œæ¯ä¸ªå‰ç«¯åº”ç”¨éƒ½å¯ç‹¬ç«‹å¼€å‘ï¼Œéƒ¨ç½²å®Œæˆåä¸»æ¡†æ¶è‡ªåŠ¨å®ŒæˆåŒæ­¥æ›´æ–°</li><li><strong>ç‹¬ç«‹è¿è¡Œ</strong>ï¼šæ¯ä¸ªå­åº”ç”¨ä¹‹é—´çŠ¶æ€éš”ç¦»ï¼Œè¿è¡Œæ—¶çŠ¶æ€ä¸å…±äº«ï¼Œåªéœ€è¦éµå¾ªç»Ÿä¸€çš„æ¥å£è§„èŒƒæˆ–è€…æ¡†æ¶ï¼Œç›¸äº’ä¹‹é—´æ˜¯ä¸å­˜åœ¨ä¾èµ–å…³ç³»çš„ã€‚</li><li><strong>å®¹é”™</strong>ï¼šå•ä¸ªåº”ç”¨æ¨¡å—æŒ‚äº†ä¸ä¼šå½±å“å…¶ä»–æ¨¡å—</li><li><strong>å¯æ‰©å±•æ€§</strong>ï¼šå•æ¯ä¸€ä¸ªæœåŠ¡å¯ä»¥ç‹¬ç«‹æ¨ªå‘æ‰©å±•æ»¡è¶³ä¸šåŠ¡ä¼¸ç¼©æ€§</li></ul><h1 id="äº”ã€é€è§†å¾®å‰ç«¯æ¶æ„"><a href="#äº”ã€é€è§†å¾®å‰ç«¯æ¶æ„" class="headerlink" title="äº”ã€é€è§†å¾®å‰ç«¯æ¶æ„"></a>äº”ã€é€è§†å¾®å‰ç«¯æ¶æ„</h1><p>å¾®å‰ç«¯æœ‰å¤šç§å®ç°æ–¹å¼ï¼Œè¿™æ¬¡ä¸»è¦è®²ç°åœ¨ç¤¾åŒºé‡Œç”¨çš„æ¯”è¾ƒå¤šçš„ä¸€ç§å®ç°æ–¹å¼â€”â€”ä½¿ç”¨æ¨¡å—åŠ è½½å™¨èšåˆå¤šä¸ªå•é¡µåº”ç”¨è¿™ç§æ–¹å¼ã€‚</p><p><img src="https://cdn.danni.cool/file/9a46bfd47807ceaf28040e08adbf3080.png" alt="1572953521033-2144d2cc-7365-4a50-87d5-1d85ae3ebec2.png"></p><p>è¿™ç§å®ç°æ–¹å¼ä¸‹ï¼Œæ ¸å¿ƒçš„æ¨¡å—åŠ è½½å™¨åœ¨è·¯ç”±è§„åˆ™åŒ¹é…çš„æ¡ä»¶ä¸‹è´Ÿè´£<strong>æ³¨å†Œ</strong>ã€<strong>è£…è½½</strong>å’Œ<strong>å¸è½½</strong>å­åº”ç”¨ã€‚</p><p>ç›¸æ¯”è¾ƒäºå•é¡µåº”ç”¨æ˜¯<strong>åº”ç”¨åˆ†å‘è·¯ç”±ï¼Œ</strong>å¾®å‰ç«¯çš„å®ç°æ–¹å¼åˆ™æ˜¯<strong>è·¯ç”±åˆ†å‘åº”ç”¨ã€‚</strong></p><h1 id="å…­ã€å¾®å‰ç«¯ä¸¤ç§é›†æˆæ–¹å¼"><a href="#å…­ã€å¾®å‰ç«¯ä¸¤ç§é›†æˆæ–¹å¼" class="headerlink" title="å…­ã€å¾®å‰ç«¯ä¸¤ç§é›†æˆæ–¹å¼"></a>å…­ã€å¾®å‰ç«¯ä¸¤ç§é›†æˆæ–¹å¼</h1><p>è®²å®Œæ¶æ„ä¸Šçš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬èŠä¸€èŠå¾®å‰ç«¯åœ¨å¼€å‘åˆ°æ„å»ºæµç¨‹ä¸Šçš„ä¸€ä¸ªå˜åŒ–ã€‚</p><h2 id="1-æ„å»ºæ—¶é›†æˆ"><a href="#1-æ„å»ºæ—¶é›†æˆ" class="headerlink" title="1.æ„å»ºæ—¶é›†æˆ"></a>1.æ„å»ºæ—¶é›†æˆ</h2><p>åœ¨å¼€å‘æ—¶ï¼Œåº”ç”¨éƒ½æ˜¯ä»¥å•ä¸€ã€å¾®å°åº”ç”¨çš„å½¢å¼å­˜åœ¨ï¼Œè€Œåœ¨è¿è¡Œæ—¶ï¼Œåˆ™é€šè¿‡æ„å»ºç³»ç»Ÿåˆå¹¶è¿™äº›åº”ç”¨ï¼Œç»„åˆæˆä¸€ä¸ªæ–°çš„åº”ç”¨ã€‚</p><p><img src="https://cdn.danni.cool/file/7bdd10b5e2fec5487dad257fbcbc2dd6.png" alt="1572951849540-b1582413-5f17-4ba8-bd2a-cb26751d5152.png"></p><p><strong>è¿™ç§å¼€å‘æ¨¡å¼æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</strong></p><ol><li>ä»£ç ç”±ç»Ÿä¸€ä»“åº“ç®¡ç†ï¼Œåªæœ‰ä¸€ä¸ªgité¡¹ç›®æ‰˜ç®¡</li><li>å…·ä½“ä¸åŒåº”ç”¨å¼€å‘é€šè¿‡git åŠŸèƒ½åˆ†æ”¯å»çº¦æŸ</li><li>ä½¿ç”¨æ„å»ºç³»ç»Ÿå®ç°ä¾èµ–çš„æ‰“åŒ…å’Œåˆ†ç¦»</li><li>æ¯”è¾ƒé€‚åˆé¡¹ç›®åˆæœŸä»£ç é‡ä¸æ˜¯å¾ˆå¤§ï¼Œæ¨¡å—å°‘ï¼Œç¼–è¯‘æ—¶é—´çŸ­çš„æƒ…å†µä¸‹</li></ol><p><strong>ä¼˜ç‚¹ï¼š</strong></p><p>âœ… ä¾èµ–ç‰ˆæœ¬å¾ˆå®¹æ˜“ç®¡ç†ï¼Œä¹Ÿèƒ½äº«å—æ„å»ºå·¥å…·åœ¨ä¾èµ–å’Œcode splitä¸Šå¸¦æ¥çš„å¥½å¤„</p><p>âœ… ä¸€æ¬¡æœ€å¤šåªéœ€è¦æ„å»ºä¸€ä¸ªé¡¹ç›®</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>âš ï¸åœ¨å¼€å‘æ¨¡å—æ—¶æ”¹åŠ¨portalçš„é¡¶å±‚è·¯ç”±ç­‰ä¼šäº§ç”Ÿå†²çª</p><p>âš ï¸ä»£ç æ„å»ºæ—¶é—´è·Ÿç€æ¨¡å—å¢åŠ è€Œå¢åŠ </p><h2 id="2-è¿è¡Œæ—¶é›†æˆ"><a href="#2-è¿è¡Œæ—¶é›†æˆ" class="headerlink" title="2.è¿è¡Œæ—¶é›†æˆ"></a>2.è¿è¡Œæ—¶é›†æˆ</h2><p>å­åº”ç”¨è‡ªå·±æ‰“åŒ…ï¼Œå¹¶å°†å„ä¸ªä»£ç è‡ªå·±ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œç”±åœ¨è¿è¡Œæ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦åŠ è½½ç›¸åº”çš„ä¸šåŠ¡æ¨¡å—å³å¯ã€‚å¯¹åº”çš„ï¼Œåœ¨æ›´æ–°ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦æ›´æ–°å¯¹åº”çš„æ¨¡å—å³å¯ã€‚</p><p><img src="https://cdn.danni.cool/file/f5bd437c5e8c2dc1b6ea69a376d3012b.png" alt="1573058236756-a2efc7e0-27c1-4440-8b0d-03c544101ca5.png"></p><h2 id="3-ä¸¤è€…å¯¹æ¯”"><a href="#3-ä¸¤è€…å¯¹æ¯”" class="headerlink" title="3.ä¸¤è€…å¯¹æ¯”"></a>3.ä¸¤è€…å¯¹æ¯”</h2><p><img src="https://cdn.danni.cool/file/15642b73aebb33cc93e974a2a1c753bd.png" alt="1573058351895-29ff8a63-e549-40a9-8b00-270c3a50498f.png"></p><h1 id="ä¸ƒã€æŠ€æœ¯æ–¹æ¡ˆ"><a href="#ä¸ƒã€æŠ€æœ¯æ–¹æ¡ˆ" class="headerlink" title="ä¸ƒã€æŠ€æœ¯æ–¹æ¡ˆ"></a>ä¸ƒã€æŠ€æœ¯æ–¹æ¡ˆ</h1><p>å¯¹äºæˆ‘æ¥è¯´ï¼Œè¿™äº›ä¸œè¥¿éƒ½æ˜¯å¯é€‰æ‹©çš„ï¼Œæ¯”å¦‚ç‹¬ç«‹éƒ¨ç½²å’Œè¿è¡Œæ˜¯é€‚åˆé¡¹ç›®æ‰©å±•åˆ°å¤šå›¢é˜Ÿï¼Œå¤§ä»£ç åº“çš„æ–¹æ¡ˆï¼Œé‚£ç°åœ¨è¿˜æ˜¯å¯ä»¥ä½¿ç”¨å†…ç½®æ„å»ºé›†æˆçš„æ–¹å¼ï¼Œäº«å—ä¸€ä¸‹webpack tree-shaking å’Œ code Split çš„ä¾¿åˆ©ï¼Œåªä¸è¿‡è¯´åœ¨ä»£ç å±‚é¢è¦åšå¥½å­åº”ç”¨çš„æ¦‚å¿µï¼Œè¿™æ ·åœ¨æŠ½ç¦»æˆä¸ºå¯ä»¥ç‹¬ç«‹éƒ¨ç½²çš„æ¨¡å—æ—¶çš„å†æ¬¡æ”¹é€ æˆæœ¬ä¸ä¼šå¾ˆå¤§ã€‚</p><p>ç›®å‰æˆ‘é€‰æ‹©äº†</p><ul><li>å­åº”ç”¨ä½¿ç”¨ç»Ÿä¸€çš„æŠ€æœ¯æ ˆvue</li><li>å¤§ä»“åº“æ¨¡å¼ï¼ˆæ„å»ºæ—¶é›†æˆï¼‰</li><li>vuex ä½œä¸ºçŠ¶æ€ç®¡ç†ï¼ˆåŸå…ˆæ˜¯reduxï¼‰</li><li>singleSPA.js ä½œä¸ºæ¨¡å—åŠ è½½å™¨</li></ul><p>å¾®å‰ç«¯æœ‰è®¸å¤šå®ç°æ–¹å¼ï¼Œä»Šå¤©æˆ‘ä»¬åªè®²åŸºäº <a href="https://single-spa.js.org/">singleSPA</a>Â æ¡†æ¶åšçš„ã€Œæ„å»ºæ—¶é›†æˆã€çš„æ•´åˆæ–¹æ¡ˆã€‚</p><p>singleSPA æ˜¯ä¸€ä¸ªæ¨¡å—åŠ è½½å™¨ï¼Œåœ¨portal é¡µé¢çš„ç®¡ç†å…¶ä»–æ¡†æ¶çš„ç”Ÿå‘½å‘¨æœŸï¼ŒåŠ è½½æˆ–è€…å¸è½½ä»–ä»¬ã€‚</p><h2 id="1-å»ºç«‹é—¨æˆ·ï¼ˆportalï¼‰åº”ç”¨"><a href="#1-å»ºç«‹é—¨æˆ·ï¼ˆportalï¼‰åº”ç”¨" class="headerlink" title="1.å»ºç«‹é—¨æˆ·ï¼ˆportalï¼‰åº”ç”¨"></a>1.å»ºç«‹é—¨æˆ·ï¼ˆportalï¼‰åº”ç”¨</h2><p><img src="https://cdn.danni.cool/file/25a43c84ac6d4ed69272f46992dde750.jpg" alt="https___cdn_%E5%89%AF%E6%9C%AC.jpg"></p><p>â€œPortalé¡¹ç›®â€æä¾›æ³¨å†Œçš„æ¥å£ï¼Œâ€œå­é¡¹ç›®â€è¿›è¡Œæ³¨å†Œï¼Œæœ€ç»ˆèšåˆæˆä¸€ä¸ªç±»å•é¡µåº”ç”¨ã€‚åœ¨æ•´å¥—æœºåˆ¶ä¸­ï¼Œæ¯”è¾ƒæ ¸å¿ƒçš„éƒ¨åˆ†æ˜¯è·¯ç”±æ³¨å†Œæœºåˆ¶ï¼Œâ€œå­é¡¹ç›®â€çš„è·¯ç”±åº”è¯¥ç”±è‡ªå·±æ§åˆ¶ï¼Œè€Œæ•´ä¸ªç³»ç»Ÿçš„å¯¼èˆªæ˜¯â€œPortalé¡¹ç›®â€æä¾›çš„ã€‚</p><p>åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜è¦</p><ul><li>å‘ˆç°å…¬ç”¨çš„é¡µé¢å…ƒç´ ï¼Œæ¯”å¦‚ä¾§è¾¹æ ã€å¤´éƒ¨æ ç›®</li><li>è·¯ç”±åŠŸèƒ½ï¼Œå‘Šè¯‰æ¯ä¸ªå¾®åº”ç”¨ä½•æ—¶å¯åŠ¨</li><li>å°è£…å…±å…¨å±€è°ƒç”¨çš„åº•å±‚æ–¹æ³•å’ŒæœåŠ¡</li><li>è§£å†³é‰´æƒé—®é¢˜</li></ul><h3 id="ä»£ç ç›®å½•çš„é‡æ–°è§„åˆ’"><a href="#ä»£ç ç›®å½•çš„é‡æ–°è§„åˆ’" class="headerlink" title="ä»£ç ç›®å½•çš„é‡æ–°è§„åˆ’"></a>ä»£ç ç›®å½•çš„é‡æ–°è§„åˆ’</h3><p>ä»¥ç±»ä¼¼å•é¡µåº”ç”¨çš„ç»“æ„è§„åˆ’portalåº”ç”¨</p><p><img src="https://cdn.danni.cool/file/0b6ac004db67e96717a7740116ee3109.png" alt="1572948379567-60b7ae85-176b-442b-a1db-a58bc0e74b51.png"></p><h3 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h3><p>é¡¹ç›®ä¸­å¼•å…¥ singleSPA å’Œå…¶æä¾›çš„vueå®ä¾‹æ³¨å†Œæ’ä»¶</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npm i single-spa single-spa-vue -d<br></code></pre></td></tr></table></figure><h3 id="å¯åŠ¨æ–‡ä»¶-app-js"><a href="#å¯åŠ¨æ–‡ä»¶-app-js" class="headerlink" title="å¯åŠ¨æ–‡ä»¶ app.js"></a>å¯åŠ¨æ–‡ä»¶ app.js</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; registerApplication, start &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;single-spa&#x27;</span>;<br><br><span class="hljs-title function_">registerApplication</span>(<br>  <span class="hljs-string">&quot;applicationName&quot;</span>, <span class="hljs-comment">// åº”ç”¨å”¯ä¸€åå­—</span><br>  <span class="hljs-function">()=&gt;</span><span class="hljs-keyword">import</span>(<span class="hljs-string">&quot;view/app1/main.js&quot;</span>), <span class="hljs-comment">//ä»¥å¼‚æ­¥ç»„ä»¶çš„æ–¹å¼å¼•è¿›æ¥</span><br>  location.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;/app1/&quot;</span>) === <span class="hljs-number">0</span> <span class="hljs-comment">// åº”ç”¨åœ¨è·¯ç”±åŒ¹é…æ—¶å±•ç¤ºï¼Œ</span><br>);<br><br><span class="hljs-comment">//å¯åŠ¨åº”ç”¨</span><br><span class="hljs-title function_">start</span>();<br></code></pre></td></tr></table></figure><h3 id="æ¨¡æ¿æ–‡ä»¶-index-html"><a href="#æ¨¡æ¿æ–‡ä»¶-index-html" class="headerlink" title="æ¨¡æ¿æ–‡ä»¶ index.html"></a>æ¨¡æ¿æ–‡ä»¶ index.html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width,initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ä¸é¦™äººæ‰ç®¡ç†åå° - jobmd_admin<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--æ­¤éƒ¨åˆ†åŠ¨æ€æ’å…¥ï¼Œå‡å°‘å¯¹åç«¯ä¾èµ–</span><br><span class="hljs-comment">  &lt;div id=&quot;sideBar&quot;&gt;&lt;/div&gt;</span><br><span class="hljs-comment">   &lt;div class=&quot;container&quot;&gt;</span><br><span class="hljs-comment">      &lt;div id=&quot;container&quot;&gt;&lt;/div&gt;</span><br><span class="hljs-comment">  &lt;/div&gt;</span><br><span class="hljs-comment">&lt;/div&gt;</span><br><span class="hljs-comment"> --&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- webpack script files will be auto injected --&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure><h2 id="2-åŒ…è£…ç°æœ‰vueåº”ç”¨"><a href="#2-åŒ…è£…ç°æœ‰vueåº”ç”¨" class="headerlink" title="2.åŒ…è£…ç°æœ‰vueåº”ç”¨"></a>2.åŒ…è£…ç°æœ‰vueåº”ç”¨</h2><h3 id="vueæ¨¡å—"><a href="#vueæ¨¡å—" class="headerlink" title="vueæ¨¡å—"></a>vueæ¨¡å—</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//page1/page1.app.js</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span>;<br><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./router&#x27;</span>;<br><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;store&#x27;</span>;<br><span class="hljs-keyword">import</span> singleSpaVue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;single-spa-vue&#x27;</span>;<br><br><span class="hljs-keyword">const</span> vueLifecycles = <span class="hljs-title function_">singleSpaVue</span>(&#123;<br>  <span class="hljs-title class_">Vue</span>,<br>  <span class="hljs-attr">appOptions</span>: &#123;<br>    <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-title class_">App</span>),<br>    <span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#container&#x27;</span><br>    router,<br>  &#125;,<br>&#125;);<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> bootstrap = vueLifecycles.<span class="hljs-property">bootstrap</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mount = vueLifecycles.<span class="hljs-property">mount</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> unmount = vueLifecycles.<span class="hljs-property">unmount</span>;<br><br></code></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼Œæœ€ç®€å•çš„åªæœ‰ä¸€ä¸ªå¾®åº”ç”¨çš„é¡¹ç›®å·²ç»å®Œæˆäº†ï¼Œæœ‰æœ¨æœ‰å¾ˆç®€å•ï¼Ÿä½†å¤šä¸ªåº”ç”¨ä¹‹é—´åˆ‡æ¢å…¶å®è¿˜æœ‰å¾ˆå¤šä¸œè¥¿è¦åšï¼Œè·¯ç”±çš„åˆ‡æ¢å¾—è‡ªå·±å†™ã€‚</p><h2 id="3-å…¬å…±åº”ç”¨-ä¾§è¾¹æ "><a href="#3-å…¬å…±åº”ç”¨-ä¾§è¾¹æ " class="headerlink" title="3.å…¬å…±åº”ç”¨-ä¾§è¾¹æ "></a>3.å…¬å…±åº”ç”¨-ä¾§è¾¹æ </h2><p><img src="https://cdn.danni.cool/file/757c5ef20bcd6a4b5af8874112e7794a.png" alt="image.png"></p><ol><li>ä¾§è¾¹æ æ˜¯portalå¸¸æ˜¾çš„å­åº”ç”¨ï¼Œæ‰€ä»¥åœ¨ <code>app.js</code> ä½¿ç”¨Â <code>registerApplication</code>Â æ³¨å†Œçš„æ—¶å€™ï¼Œç¬¬ä¸‰å‚æ•°éœ€è¦å§‹ç»ˆä¸º <code>true</code> è¿™æ ·å³ä½¿è·¯ç”±å˜åŒ–ï¼Œä¾§è¾¹æ é¡µæ°¸è¿œä¸ä¼šæ¶ˆå¤±ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// sideæ¨¡å—</span><br><span class="hljs-title function_">registerApplication</span>(<span class="hljs-string">&quot;sideBar&quot;</span>, <span class="hljs-function">()=&gt;</span><span class="hljs-keyword">import</span>(<span class="hljs-string">&quot;view/app1/sideBar.app.js&quot;</span>),<br>  <span class="hljs-literal">true</span> <span class="hljs-comment">// å§‹ç»ˆå±•ç¤ºåˆ™è¿”å›true</span><br>);<br><br><span class="hljs-comment">// å…¶ä»–æ¨¡å—</span><br><span class="hljs-title function_">registerApplication</span>(<span class="hljs-string">&quot;otherApplication&quot;</span>, <span class="hljs-function">()=&gt;</span><span class="hljs-keyword">import</span>(<span class="hljs-string">&quot;view/app1/otherApplication.app.js&quot;</span>),<br>  <span class="hljs-function">() =&gt;</span> location.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;/otherApplication/&quot;</span>) === <span class="hljs-number">0</span><br>);<br><br></code></pre></td></tr></table></figure><ol><li>ä¾§è¾¹æ æœ‰å¤šç§ç»„åˆæ–¹å¼ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨é…ç½®é¡¹æ¥ç»´æŠ¤ã€‚</li></ol><p>è¿è¥Cç«¯</p><p><img src="https://cdn.danni.cool/file/2e0f7c2799557f47a96cc70b2d4d99e4.png" alt="Untitled.png"></p><p>ä»»åŠ¡ä¸­å¿ƒ</p><p><img src="https://cdn.danni.cool/file/4c3aaa660a53872573f924251d12dadc.png" alt="Untitled.png"></p><p>å°ç¨‹åº</p><p><img src="https://cdn.danni.cool/file/b927a785bc194941a83d1613a34de2af.png" alt="Untitled.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-comment">// æ ¹è·¯ç”±é‡å®šå‘</span><br>  <span class="hljs-attr">homeRedirect</span>: <span class="hljs-string">&#x27;#/miniProgramMHR/userManage&#x27;</span>,<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * ä»¥ä¸‹é…ç½®menu</span><br><span class="hljs-comment">   * æ³¨æ„ï¼škeyå€¼ä¸èƒ½ç›¸åŒï¼Œä¸ç„¶è¿™é‡Œæ³¨å†Œçš„é«˜äº®å’Œå±•å¼€äºŒçº§èœå•å¿…å®šæ˜¾ç¤ºä¸æ­£å¸¸</span><br><span class="hljs-comment">   *  */</span><br>  <span class="hljs-attr">menuList</span>: [<br>    &#123;<br>      <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;home&#x27;</span>,<br>      <span class="hljs-attr">menuName</span>: <span class="hljs-string">&#x27;ç®¡ç†åå°é¦–é¡µ&#x27;</span>,<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/admin/guessoneguess.do&#x27;</span> <span class="hljs-comment">// å¤–é“¾ä¸ä»¥#å¼€å¤´</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;miniProgramMHR&#x27;</span>,<br>      <span class="hljs-attr">menuName</span>: <span class="hljs-string">&#x27;MHRå°ç¨‹åºç®¡ç†&#x27;</span>,<br>      <span class="hljs-attr">children</span>: [<br>        &#123;<br>          <span class="hljs-attr">menuName</span>: <span class="hljs-string">&#x27;ç”¨æˆ·ç®¡ç†&#x27;</span>,<br>          <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;userManage&#x27;</span>,<br>          <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;#/miniProgramMHR/userManage&#x27;</span>,<br>          <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;../../view/miniProgramMHR/userManage/app.js&#x27;</span>)<br>        &#125;<br>      ]<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4-è·¯ç”±å’Œç»„ä»¶æ³¨å†Œ"><a href="#4-è·¯ç”±å’Œç»„ä»¶æ³¨å†Œ" class="headerlink" title="4.è·¯ç”±å’Œç»„ä»¶æ³¨å†Œ"></a>4.è·¯ç”±å’Œç»„ä»¶æ³¨å†Œ</h2><p>å› ä¸ºè€ƒè™‘åˆ°urlçš„historyæ¨¡å¼å¯¹æœåŠ¡å™¨æœ‰æ”¹é€ æˆæœ¬ï¼Œæ‰€ä»¥ä¸‹é¢éƒ½æ˜¯ä»¥hashæ¨¡å¼å»åšè·¯ç”±çš„ç®¡ç†ã€‚</p><p>åº”ç”¨çš„è·¯ç”±åœ¨singleSPAé‡Œæ³¨å†Œï¼Œâ€œåº”ç”¨çš„å­é¡¹ç›®â€çš„è·¯ç”±åº”è¯¥ç”±è‡ªå·±æ§åˆ¶</p><p><img src="https://cdn.danni.cool/file/e77f04ffd859a6d46f126a2b799afc8b.jpg" alt="123123.jpg"></p><h3 id="queryéƒ¨åˆ†"><a href="#queryéƒ¨åˆ†" class="headerlink" title="queryéƒ¨åˆ†"></a>queryéƒ¨åˆ†</h3><p>åŒºåˆ†ä¸åŒçš„ä¾§è¾¹æ ï¼Œä»è€ŒåŠ è½½ä¸åŒçš„ä¾§è¾¹æ é…ç½®</p><p><img src="https://cdn.danni.cool/file/8db07f9b0faf054389b3597e3407e773.png" alt="1573051069905-cbcb8650-46ed-45f3-ae20-389d8e17929b.png"></p><h3 id="hashéƒ¨åˆ†"><a href="#hashéƒ¨åˆ†" class="headerlink" title="hashéƒ¨åˆ†"></a>hashéƒ¨åˆ†</h3><p>ç”¨æ¥å®šä¹‰çˆ¶å­è·¯ç”±</p><p><strong>çˆ¶è·¯ç”± router.mhr.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">menuList</span>: [<br>  &#123;<br>    <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;home&#x27;</span>,<br>    <span class="hljs-attr">menuName</span>: <span class="hljs-string">&#x27;ç®¡ç†åå°é¦–é¡µ&#x27;</span>,<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/admin/guessoneguess.do&#x27;</span> <span class="hljs-comment">// å¤–é“¾ä¸ä»¥#å¼€å¤´</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;miniProgramMHR&#x27;</span>,<br>    <span class="hljs-attr">menuName</span>: <span class="hljs-string">&#x27;MHRå°ç¨‹åºç®¡ç†&#x27;</span>,<br>    <span class="hljs-attr">children</span>: [<br>      &#123;<br>        <span class="hljs-attr">menuName</span>: <span class="hljs-string">&#x27;ç”¨æˆ·ç®¡ç†&#x27;</span>,<br>        <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;userManage&#x27;</span>,<br>        <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;#/miniProgramMHR/userManage&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;../../view/miniProgramMHR/userManage/app.js&#x27;</span>)<br>      &#125;<br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure><p><strong>å­è·¯ç”± page1&#x2F;page1.router.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Router</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Router</span>(&#123;<br>  <span class="hljs-attr">routes</span>: [<br>    &#123;<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/miniProgramMHR/userManage&#x27;</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;list&#x27;</span>,<br>      <span class="hljs-attr">component</span>: <span class="hljs-title class_">List</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/miniProgramMHR/userManage/detail&#x27;</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;detail&#x27;</span>,<br>      <span class="hljs-attr">component</span>: <span class="hljs-title class_">Detail</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/miniProgramMHR/userManage/audit&#x27;</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;audit&#x27;</span>,<br>      <span class="hljs-attr">component</span>: <span class="hljs-title class_">Detail</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/miniProgramMHR/userManage/edit&#x27;</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;edit&#x27;</span>,<br>      <span class="hljs-attr">component</span>: <span class="hljs-title class_">Detail</span><br>    &#125;<br>  ]<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="å…¨å±€çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ"><a href="#å…¨å±€çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ" class="headerlink" title="å…¨å±€çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ"></a>å…¨å±€çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ</h3><p>ä¾§è¾¹æ åº”ç”¨éœ€è¦tabåç§°ã€çˆ¶å­ä¹‹é—´çš„çº§è”å…³ç³»å’Œå¯¹åº”çš„è·¯ç”±ï¼Œè€Œportalåº”ç”¨åˆ™éœ€è¦çŸ¥é“å½“å‰æ³¨å†Œå“ªäº›ç»„ä»¶ï¼Œå¯¹åº”çš„è·¯ç”±å…³ç³»å¦‚ä½•ï¼Œè¿™éƒ¨åˆ†æ”¾åœ¨portalåº”ç”¨å±‚é¢å»åšä¼šæ¯”è¾ƒå¥½ï¼Œæ‰€ä»¥ä»–ä»¬ä¹‹é—´çš„å…±äº«çŠ¶æ€æˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€ä¸ªçŠ¶æ€ç®¡ç†å»å…±äº«ï¼Œè·¯ç”±å˜åŒ–åï¼Œç”±portal å‘Šè¯‰ä¾§è¾¹æ ï¼Œå±•ç¤ºå“ªäº›é…ç½®é¡¹ï¼Œå½“å‰å“ªä¸ªæ˜¯é«˜äº®é€‰é¡¹ã€‚</p><p><img src="https://cdn.danni.cool/file/db1a18eb3187af85cd6a49258cf42504.png" alt="image.png"></p><p>å› ä¸ºä½¿ç”¨äº†vueå…¨å®¶æ¡¶ï¼Œvuexç”¨èµ·æ¥å°±å¾ˆå¾—å¿ƒåº”æ‰‹ï¼Œä½†å¦‚æœæ˜¯å¤šç§æŠ€æœ¯æ ˆçš„è¯ï¼Œreduxä¹Ÿå¯ä»¥é€‰æ‹©</p><p>éœ€è¦çš„å­åº”ç”¨æ³¨å…¥store</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/store/index&#x27;</span><br><br><span class="hljs-keyword">const</span> vueLifeCycles = <span class="hljs-title function_">singleSpaVue</span>(&#123;<br>  <span class="hljs-title class_">Vue</span>,<br>  <span class="hljs-attr">appOptions</span>: &#123;<br>    <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-title class_">App</span>),<br>    <span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#sideBar&#x27;</span>,<br>    store<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><p>portal åº”ç”¨ app.jsåœ¨è·¯ç”±å˜åŒ–æ—¶commitäº‹ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store/index&#x27;</span><br><br><span class="hljs-comment">// è®¾ç½®é«˜äº®æ¨¡å—</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;single-spa:routing-event&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-comment">// æ ¹è·¯ç”±çš„è¯è·³è½¬</span><br>  <span class="hljs-keyword">if</span> (location.<span class="hljs-property">hash</span> === <span class="hljs-string">&#x27;#/&#x27;</span> || location.<span class="hljs-property">hash</span> === <span class="hljs-string">&#x27;&#x27;</span>) &#123;<br>    <span class="hljs-title function_">navigateToUrl</span>(homeRedirect)<br>    <span class="hljs-keyword">return</span><br>  &#125;<br>  store.<span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;SET_SIDEBAR&#x27;</span>, &#123;<span class="hljs-attr">menu</span>: menuList, <span class="hljs-attr">highlightTab</span>: <span class="hljs-title function_">getCurrentMenuName</span>(menuList)&#125;)<br>&#125;)<br><br></code></pre></td></tr></table></figure><h2 id="6-å…¬å…±æœåŠ¡"><a href="#6-å…¬å…±æœåŠ¡" class="headerlink" title="6.å…¬å…±æœåŠ¡"></a>6.å…¬å…±æœåŠ¡</h2><p>ç°åœ¨æ¯ä¸ªå­åº”ç”¨éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¼šå­˜åœ¨å…±äº«ä¸€äº›åº•å±‚æœåŠ¡çš„æƒ…å†µï¼Œæ¯”å¦‚æˆ‘ä»¬å°è£…ä¸€ä¸ªaxiosçš„ request.js å»æ‹¦æˆªä¸€äº›å¼‚å¸¸æƒ…å†µç»Ÿä¸€å¤„ç†ï¼Œä¸€äº›å…¬å…±æœåŠ¡æ¯”å¦‚è¯·æ±‚loadingï¼Œtoastå°±æ¯”è¾ƒé€‚åˆæ”¾åœ¨portalè¿™å±‚</p><p>é€šè¿‡å°†å®ä¾‹æŒ‚è½½åœ¨windowä¸Šå®ç°æ–¹æ³•ä¸Šçš„å…±äº«</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> showLoading = <span class="hljs-variable language_">window</span>.<span class="hljs-property">$service</span>.<span class="hljs-property">showLoading</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> hideLoading = <span class="hljs-variable language_">window</span>.<span class="hljs-property">$service</span>.<span class="hljs-property">hideLoading</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">Message</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">$service</span>.<span class="hljs-property">Message</span><br></code></pre></td></tr></table></figure><h2 id="7-æ ·å¼éš”ç¦»"><a href="#7-æ ·å¼éš”ç¦»" class="headerlink" title="7.æ ·å¼éš”ç¦»"></a>7.æ ·å¼éš”ç¦»</h2><p>å¤šä¸ªå­åº”ç”¨ä¹‹é—´å¼€å‘ï¼Œæœ€ä¸èƒ½å‡ºç°çš„å°±æ˜¯æ ·å¼ä¹‹é—´çš„ç›¸äº’å¼•ç”¨å’Œè¦†ç›–ï¼Œåœ¨è¿™ä¸€å±‚é¢ä¸Šï¼Œéœ€è¦æåŠ›å»é¿å…ï¼Œæˆ‘ä»¬è¦é˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œç›®å‰è¿˜æ˜¯é€šè¿‡vue scoped style å»é¿å…ï¼ŒåæœŸåº”è¯¥ä½¿ç”¨babelåœ¨æ‰“åŒ…é˜¶æ®µå°±åŠ ä¸Šå‘½åç©ºé—´ã€‚</p><p><img src="https://cdn.danni.cool/file/e4f1024b4a0a4de1537af45d45433dd9.png" alt="1573058034037-304f9182-da46-4d4f-a4f7-82eeac5b06c0.png"></p><h2 id="8-å…¬å…±ä¾èµ–æŠ½ç¦»"><a href="#8-å…¬å…±ä¾èµ–æŠ½ç¦»" class="headerlink" title="8.å…¬å…±ä¾èµ–æŠ½ç¦»"></a>8.å…¬å…±ä¾èµ–æŠ½ç¦»</h2><p><img src="https://cdn.danni.cool/file/0a16e249f298b75422cb8cee9135d222.png" alt="1573059190834-fefe4fb7-72c7-4e29-92ea-9105185904e2.png"></p><h2 id="9-å®Œæ•´ç‰ˆ-app-js"><a href="#9-å®Œæ•´ç‰ˆ-app-js" class="headerlink" title="9.å®Œæ•´ç‰ˆ app.js"></a>9.å®Œæ•´ç‰ˆ app.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; start, registerApplication, navigateToUrl &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;single-spa&#x27;</span><br><span class="hljs-keyword">import</span> &#123; matchRoute, getRouteMap, getCurrentMenuName &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./router/utils&#x27;</span><br><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store/index&#x27;</span><br><span class="hljs-keyword">import</span> getUrlQuery <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/single-spa/utils/getUrlQuery&#x27;</span><br><span class="hljs-keyword">import</span> &#123;sideBarComponent, sideBarMenu&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./router/index&#x27;</span><br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;./utils/service&#x27;</span> <span class="hljs-comment">// å…¨å±€æç¤ºç»„ä»¶</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;iview/dist/styles/iview.css&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;./style/index.less&#x27;</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  åŠ¨æ€æ’å…¥domæŒ‚è½½èŠ‚ç‚¹ï¼Œå‡å°‘å¯¹åç«¯ä¾èµ–</span><br><span class="hljs-comment"> * &lt;div id=&quot;app&quot;&gt;</span><br><span class="hljs-comment"> *    &lt;div id=&quot;sideBar&quot;&gt;&lt;/div&gt;</span><br><span class="hljs-comment"> *    &lt;div class=&quot;container&quot;&gt;</span><br><span class="hljs-comment"> *        &lt;div id=&quot;container&quot;&gt;&lt;/div&gt;</span><br><span class="hljs-comment"> *    &lt;/div&gt;</span><br><span class="hljs-comment"> * &lt;/div&gt;</span><br><span class="hljs-comment"> *  */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">initDomHook</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> frag = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createDocumentFragment</span>()<br>  <span class="hljs-keyword">const</span> sideBarEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;DIV&#x27;</span>)<br>  <span class="hljs-keyword">const</span> containerEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;DIV&#x27;</span>)<br>  <span class="hljs-keyword">const</span> appEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;DIV&#x27;</span>)<br><br>  sideBarEl.<span class="hljs-property">id</span> = <span class="hljs-string">&#x27;sideBar&#x27;</span><br>  appEl.<span class="hljs-property">id</span> = <span class="hljs-string">&#x27;container&#x27;</span><br>  containerEl.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;container&#x27;</span><br><br>  frag.<span class="hljs-title function_">appendChild</span>(sideBarEl)<br>  frag.<span class="hljs-title function_">appendChild</span>(containerEl)<br>  frag.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.container&#x27;</span>).<span class="hljs-title function_">append</span>(appEl)<br><br>  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#app&#x27;</span>).<span class="hljs-title function_">append</span>(frag)<br>&#125;<br><br><span class="hljs-comment">// ç»‘å®šè·¯ç”±äº‹ä»¶</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">bindRouterEvent</span>(<span class="hljs-params">menuList, homeRedirect</span>) &#123;<br>  <span class="hljs-comment">// è®¾ç½®é«˜äº®æ¨¡å—</span><br>  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;single-spa:routing-event&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// æ ¹è·¯ç”±çš„è¯è·³è½¬</span><br>    <span class="hljs-keyword">if</span> (location.<span class="hljs-property">hash</span> === <span class="hljs-string">&#x27;#/&#x27;</span> || location.<span class="hljs-property">hash</span> === <span class="hljs-string">&#x27;&#x27;</span>) &#123;<br>      <span class="hljs-title function_">navigateToUrl</span>(homeRedirect)<br>      <span class="hljs-keyword">return</span><br>    &#125;<br>    store.<span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;SET_SIDEBAR&#x27;</span>, &#123;<span class="hljs-attr">menu</span>: menuList, <span class="hljs-attr">highlightTab</span>: <span class="hljs-title function_">getCurrentMenuName</span>(menuList)&#125;)<br>  &#125;)<br>&#125;<br><br><span class="hljs-comment">// æ³¨å†Œè·¯ç”±å’Œä¾§è¾¹æ </span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">registerRouter</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// æ ¹æ®å½“å‰è·¯ç”±æ³¨å†Œapp</span><br>  <span class="hljs-title function_">registerApplication</span>(sideBarComponent.<span class="hljs-property">key</span>, sideBarComponent.<span class="hljs-property">component</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-literal">true</span>)<br><br>  <span class="hljs-comment">// æ³¨å†Œå½“å‰çš„menuèœå•</span><br>  <span class="hljs-keyword">const</span> currentApp = <span class="hljs-title function_">getUrlQuery</span>(<span class="hljs-string">&#x27;app&#x27;</span>) <span class="hljs-comment">// exp: ?app=&quot;2c&quot;</span><br>  <span class="hljs-keyword">const</span> currentAppCfg = sideBarMenu[currentApp]<br><br>  <span class="hljs-keyword">if</span> (!currentApp) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;æœªå‘ç°?app=å‚æ•°ï¼Œåº”ç”¨å¯åŠ¨å¤±è´¥&#x27;</span>)&#125;<br>  <span class="hljs-keyword">if</span> (!currentAppCfg) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æœªæ‰¾åˆ°?app=<span class="hljs-subst">$&#123;currentApp&#125;</span> åŒ¹é…çš„è·¯ç”±ï¼Œåº”ç”¨å¯åŠ¨å¤±è´¥`</span>)&#125;<br><br>  <span class="hljs-keyword">const</span> &#123; menuList, homeRedirect &#125; = currentAppCfg<br><br>  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(<span class="hljs-title function_">getRouteMap</span>(menuList)).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>    item.<span class="hljs-property">component</span> &amp;&amp; <span class="hljs-title function_">registerApplication</span>(item.<span class="hljs-property">key</span>, item.<span class="hljs-property">component</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">matchRoute</span>(item.<span class="hljs-property">path</span>))<br>  &#125;)<br><br>  <span class="hljs-title function_">bindRouterEvent</span>(menuList, homeRedirect)<br><br>  <span class="hljs-variable language_">window</span>.<span class="hljs-property">store</span> = store<br>&#125;<br><br><br>;(<span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-title function_">registerRouter</span>()<br>  <span class="hljs-title function_">initDomHook</span>()<br>  <span class="hljs-title function_">start</span>()<br>&#125;)()<br><br></code></pre></td></tr></table></figure><h1 id="å…«ã€æ€»ç»“"><a href="#å…«ã€æ€»ç»“" class="headerlink" title="å…«ã€æ€»ç»“"></a>å…«ã€æ€»ç»“</h1><ol><li>æˆ‘ä»¬å¦‚ä½•å®ç°åœ¨ä¸€ä¸ªé¡µé¢é‡Œæ¸²æŸ“å¤šç§æŠ€æœ¯æ ˆ? singleSPA</li><li>ä¸åŒç‹¬ç«‹æ¨¡å—ä¹‹é—´å¦‚ä½•é€šè®¯? ç°æˆçš„çŠ¶æ€ç®¡ç†ä½¿ç”¨å…¨å±€çŠ¶æ€ç®¡ç†æ³¨å…¥å„ä¸ªå­åº”ç”¨</li><li>å¦‚ä½•é€šè¿‡è·¯ç”±æ¸²æŸ“åˆ°æ­£ç¡®çš„æ¨¡å—? é€šè¿‡è‡ªå·±å®šä¹‰çš„è·¯ç”±è§„åˆ™ï¼Œé€šè¿‡hashè·¯ç”±çš„æ–¹å¼ç®¡ç†å­æ¨¡å—</li><li>åœ¨ä¸åŒå­åº”ç”¨ä¹‹é—´çš„è·¯ç”±è¯¥å¦‚ä½•æ­£ç¡®è§¦å‘? ç»Ÿä¸€ä½ç½®ç®¡ç†ï¼Œé˜²æ­¢å‘½åå†²çª</li><li>é¡¹ç›®ä»£ç åˆ«åˆ‡å‰²ä¹‹å,é€šè¿‡ä½•ç§æ–¹å¼åˆå¹¶åˆ°ä¸€èµ·? æ„å»ºæ—¶é›†æˆï¼Œåˆ†åŒ…é€šè¿‡å¼‚æ­¥ç»„ä»¶åŠ è½½è¿‡æ¥</li><li>å‰ç«¯å¾®æœåŠ¡åŒ–åæˆ‘ä»¬è¯¥å¦‚ä½•ç¼–å†™æˆ‘ä»¬çš„ä»£ç ? å»routerå®šä¹‰é¡¶å±‚è·¯ç”±ï¼Œé€šè¿‡hashå­è·¯ç”±ç®¡ç†è‡ªå·±è·¯ç”±</li><li>ç‹¬ç«‹å›¢é˜Ÿä¹‹é—´è¯¥å¦‚ä½•åä½œ?Â gitåˆ†æ”¯åŠŸèƒ½åˆ†æ”¯</li></ol><h1 id="ä¹ã€TODO"><a href="#ä¹ã€TODO" class="headerlink" title="ä¹ã€TODO"></a>ä¹ã€TODO</h1><ul><li>åŠ¨æ€å¢å‡åº”ç”¨ä¾èµ–</li><li>vendoræ‰“åŒ…åªæ‰“åŒ…å…¬å…±ä¾èµ–ï¼Œå„è‡ªä¾èµ–è‡ªå·±ç®¡ç†</li><li>cli ä½¿å¼€å‘æ–°æ¨¡å—å’Œæ–°é¡¹ç›®æ›´ç®€å•</li><li>css ä½œç”¨åŸŸçš„ä¸¥æ ¼éš”ç¦»</li><li>contentHash</li><li>è¿è¡Œæ—¶ä¾èµ–</li></ul><h1 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h1><ul><li><a href="https://www.yuque.com/chentianyu/ykdmaz/ela3k3#8JBgz">infoQ -Â å¤§å‰ç«¯æ—¶ä»£ä¸‹çš„å¾®å‰ç«¯æ¶æ„</a></li><li><a href="https://juejin.im/post/5cadd7835188251b2f3a4bb0">æ˜é‡‘ - å¾®å‰ç«¯å®è·µ</a></li><li><a href="http://insights.thoughtworkers.org/micro-frontends-1/">ThoughtWorksæ´è§ -ã€Œå¾®å‰ç«¯ã€- å°†å¾®æœåŠ¡ç†å¿µæ‰©å±•åˆ°å‰ç«¯å¼€å‘ï¼ˆç†è®ºç¯‡ï¼‰</a></li><li><a href="http://insights.thoughtworks.cn/micro-frontends-2/">ThoughtWorksæ´è§ -ã€Œå¾®å‰ç«¯ã€- å°†å¾®æœåŠ¡ç†å¿µæ‰©å±•åˆ°å‰ç«¯å¼€å‘ï¼ˆå®æˆ˜ç¯‡ï¼‰</a></li><li><a href="https://yq.aliyun.com/articles/715922">äº‘æ –ç¤¾åŒº - å¯èƒ½æ˜¯ä½ è§è¿‡æœ€å®Œå–„çš„å¾®å‰ç«¯è§£å†³æ–¹æ¡ˆ</a><a href="https://juejin.im/post/5cadd7835188251b2f3a4bb0"></a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Tech</category>
      
    </categories>
    
    
    <tags>
      
      <tag>single-spa</tag>
      
      <tag>Micro-Frontends</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>G2å®ç°å¤§æ•°æ®å±•ç¤ºæ¨¡å—</title>
    <link href="/2019/09/05/G2%E5%AE%9E%E7%8E%B0%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA%E6%A8%A1%E5%9D%97/"/>
    <url>/2019/09/05/G2%E5%AE%9E%E7%8E%B0%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA%E6%A8%A1%E5%9D%97/</url>
    
    <content type="html"><![CDATA[<h1 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h1><p>æœ¬æ¬¡å›é¡¾äº†ä¸šåŠ¡éœ€æ±‚é‡Œå¤§æ•°æ®æ¨¡å—çš„å®ç°è¿‡ç¨‹ã€‚è¯¥é¡¹ç›®å‘å¸ƒä»¥åä¹‹å‰æœ‰æŠ•å±åœ¨å…¬å¸å¤§å±ä¸Šï¼ŒæŸå¤©å¶ç„¶ç»è¿‡ä»¥åçœ‹äº†å¾ˆè‡ªè±ªå•Šå“ˆå“ˆã€‚å›é¡¾å¿ƒè·¯å†ç¨‹ï¼Œä»æ¥åˆ°éœ€æ±‚åæ¶è¡¥æ­£æ€åˆ†å¸ƒå‡½æ•°ï¼Œåˆ°æŠ€æœ¯é€‰å‹ä¸­é€”ä»D3è½¬å‘G2ï¼Œå†åˆ°G2å›¾è¡¨å®ç°åˆ°80%ä»¥åï¼Œå‘ç°å…¶åŠ¨æ•ˆæ–¹é¢APIèƒ½åŠ›ä¸è¶³ä¹‹åç¡¬æ ¸åšå®Œä»¥åå¯è°“ä¸€æ³¢ä¸‰æŠ˜ï¼Œè¯¥éœ€æ±‚ä¸€å…±åšäº†6å¤©ï¼Œä»Šå¤©åˆšå¥½å›é¡¾ä¸€ä¸‹ï¼Œæ­£å¥½ä¹Ÿå¯ä»¥å’Œä¹‹å‰å¼€å‘ä½¿ç”¨è¿‡çš„eChartã€D3åšä¸€ä¸ªç®€å•çš„å¯¹æ¯”ã€‚</p><p><img src="https://cdn.danni.cool/file/bc2b40e50b4f83e0c1f47520034c507e.jpeg" alt="1567610715274-0d2e6f41-d7c3-4b21-a165-4b4d525423a1.jpeg"></p><h1 id="ä¸€ã€éœ€æ±‚åˆ†æ"><a href="#ä¸€ã€éœ€æ±‚åˆ†æ" class="headerlink" title="ä¸€ã€éœ€æ±‚åˆ†æ"></a>ä¸€ã€éœ€æ±‚åˆ†æ</h1><p>éœ€æ±‚å¾ˆç®€å•ï¼Œå¤§æ•°æ®æ¨¡å—éœ€è¦å‰ç«¯ç”»ä¸¤ä¸ªå›¾ï¼Œä¸€ä¸ªæ˜¯é¢ç§¯æ›²çº¿å›¾ã€ä¸€ä¸ªæ˜¯ç¯å½¢è¿›åº¦æ¡ã€‚</p><h2 id="é¢ç§¯æ›²çº¿å›¾"><a href="#é¢ç§¯æ›²çº¿å›¾" class="headerlink" title="é¢ç§¯æ›²çº¿å›¾"></a>é¢ç§¯æ›²çº¿å›¾</h2><ul><li>é¢ç§¯æ›²çº¿å›¾éœ€è¦ä½¿ç”¨æ›²çº¿ç»˜åˆ¶å‡ºå›ºå®šçš„èµ°åŠ¿</li><li>çº¿æ¡å’Œé¢ç§¯çš„é˜´å½±é¢œè‰²ä¸åŒ</li><li>åˆæ¬¡æ¸²æŸ“æ—¶éœ€è¦æœ‰è‡ªå·¦å‘å³çš„è¿›å…¥åŠ¨ç”»</li><li>ç›¸åº”æ•°å€¼å¤„æ ‡æ³¨èµ·æ±‚èŒè€…çš„è–ªæ°´ä½ç½®</li></ul><h2 id="ç¯å½¢è¿›åº¦æ¡"><a href="#ç¯å½¢è¿›åº¦æ¡" class="headerlink" title="ç¯å½¢è¿›åº¦æ¡"></a>ç¯å½¢è¿›åº¦æ¡</h2><ul><li>æ•°æ®å¤§å°ä½¿ç”¨ç¯å½¢è¿›åº¦æ¡ç™¾åˆ†æ¯”å‘ˆç°</li><li>åˆæ¬¡è¿›å…¥æ—¶æœ‰ä¸ªæ•°æ®å¢é•¿çš„åŠ¨æ•ˆã€‚</li><li>ç¯å½¢è¿›åº¦æ¡æœ‰ä¸ªç™½è‰²åœ†è·Ÿç€åŠ¨</li></ul><p>emmmmâ€¦.éœ€æ±‚çœ‹èµ·æ¥å¥½åƒä¸è¿‡åˆ†</p><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><p><img src="https://cdn.danni.cool/file/69a80c41d02875c5c4cc747fb59af25f.gif" alt="Untitled.gif"></p><h1 id="äºŒã€ç”»å›¾å±Šçš„PK"><a href="#äºŒã€ç”»å›¾å±Šçš„PK" class="headerlink" title="äºŒã€ç”»å›¾å±Šçš„PK"></a>äºŒã€ç”»å›¾å±Šçš„PK</h1><p>å¬åˆ°æ•°æ®å¯è§†åŒ–éœ€æ±‚ï¼Œé©¬ä¸Šè„‘è¢‹é‡Œå‡ºç°ä¸‰å¤§æ¡†æ¶ï¼Œ<del>vueï¼Œreactã€angular</del>ï¼Œæ˜¯ echartã€G2ã€D3ã€‚</p><h2 id="å¤šè€Œå…¨çš„EChart"><a href="#å¤šè€Œå…¨çš„EChart" class="headerlink" title="å¤šè€Œå…¨çš„EChart"></a>å¤šè€Œå…¨çš„EChart</h2><p>ä»¥å‰ç”¨echartåšè¿‡ç§»åŠ¨ç«¯çš„é¥¼å›¾å’ŒæŠ˜çº¿å›¾ï¼Œè€Œechartä½œä¸ºä¸€æ¬¾å¼€ç®±å³ç”¨çš„å›¾è¡¨åº“ï¼Œç¡®å®å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯echartçš„å®šåˆ¶èƒ½åŠ›æ¯”è¾ƒå¼±ï¼Œå¯¹äºè¿™ä¹ˆç®€å•çš„å›¾ä¼°è®¡å…‰æŸ¥apiå’Œåˆ å‡é…ç½®é¡¹å°±è¦å¼„å¾ˆä¹…ï¼Œè€Œä¸”æœ€åæ˜¯å¦èƒ½è¿˜åŸåˆ°è®¾è®¡ç¨¿è¿™æ ·æ ·å¼åº”è¯¥æ˜¯ä¸ªé—®å·ï¼Ÿä¸è¿‡ä¹‹æ‰€ä»¥ç”¨æƒ¯äº†echartçš„ä¸€æ­¥åˆ°ä½ï¼Œä¹Ÿæƒ³æ¢ç©¶ä¸‹ç”»å›¾æ›´åŠ ååº•å±‚çš„å†…å®¹ã€‚</p><h2 id="é™¡å³­çš„D3"><a href="#é™¡å³­çš„D3" class="headerlink" title="é™¡å³­çš„D3"></a>é™¡å³­çš„D3</h2><p>G2æ˜¯ç”»å›¾å±Šçš„é¢å›¢ï¼Œå¯å®šåˆ¶åŒ–èƒ½åŠ›æ¯”echartç›¸å¯¹é«˜ï¼Œç”¨å®ƒæ¥å®ç°åº”è¯¥æ²¡é—®é¢˜ã€‚å¥½ï¼Œé‚£æˆ‘è¿˜æ˜¯ç”¨D3å§ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥ç»™å¤§å®¶å†™ä¸€ç¯‡D3çš„åˆ†äº«äº†ï¼Œä¸è¿‡å¤§å®¶ä¹Ÿå‘ç°äº†ï¼Œæœ€ç»ˆæ–‡ç« çš„æ ‡é¢˜æ˜¯è®² G2è€Œä¸æ˜¯D3ï¼Œå› ä¸ºåœ¨D3ä¸Šç¢°å£äº†ã€‚</p><p>æˆ‘ä»¬ç®€å•è¯´ä¸€ä¸‹D3å’ŒG2çš„åŒºåˆ«ï¼ŒD3ç®€ç§°â€œç”»å›¾å±Šçš„jqueryâ€ï¼Œå› ä¸ºD3æ˜¯åŸºäºSVGçš„ï¼Œè€ŒG2åˆ™æ˜¯åŸºäºCanvasï¼ˆå½“ç„¶3.2.7ç‰ˆæœ¬ä¹Ÿå¼€å§‹æ”¯æŒä»¥SVGæ¸²æŸ“ï¼‰ï¼Œä¸¤è€…å…¶å®å„æœ‰ä¼˜ç¼ºç‚¹ï¼Œã€Œæ•°æ®å¯è§†åŒ–å°ç»„ã€æœ€è¿‘æ¬è¿çš„è¿™ç¯‡æ–‡ç« </p><p><a href="https://www.yuque.com/docs/share/eda67c40-b202-48d3-97b7-fb7a59a2cc26">ã€Šé€‰æ‹©Canvasè¿˜æ˜¯SVGã€‹</a>ç®€å•ä»‹ç»äº†Canvas å’Œ SVGçš„é€‚ç”¨åœºæ™¯å’Œæ€§èƒ½å·®å¼‚ã€‚</p><p><img src="https://cdn.danni.cool/file/5ceb9b790534c2c3fc05d2384a90d915.png" alt="1567615980097-741ce71b-ec50-47fe-9608-5e78bf2e2c72.png"></p><p><strong>ç®€å•æ‘˜å½•ä¸€ä¸‹ï¼š</strong></p><p>å¦‚æœå•å°±å›¾è¡¨åº“çš„è§†è§’æ¥çœ‹ï¼Œé€‰æ‹© Canvas å’Œ SVG å„æœ‰åƒç§‹ã€‚å°ç”»å¸ƒã€å¤§æ•°æ®é‡çš„åœºæ™¯é€‚åˆç”¨ Canvasï¼Œè­¬å¦‚çƒ­åŠ›å›¾ã€å¤§æ•°æ®é‡çš„æ•£ç‚¹å›¾ç­‰ã€‚å¦‚æœç”»å¸ƒéå¸¸å¤§ï¼Œæœ‰ç¼©æ”¾ã€å¹³ç§»ç­‰é«˜é¢‘çš„äº¤äº’ï¼Œæˆ–è€…ç§»åŠ¨ç«¯å¯¹å†…å­˜å ç”¨é‡éå¸¸æ•æ„Ÿç­‰åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨ SVG çš„æ–¹æ¡ˆã€‚</p><h3 id="ä¸ºä»€ä¹ˆåˆæœŸä½¿ç”¨D3ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆåˆæœŸä½¿ç”¨D3ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆåˆæœŸä½¿ç”¨D3ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼Ÿ"></a>ä¸ºä»€ä¹ˆåˆæœŸä½¿ç”¨D3ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼Ÿ</h3><p>å¥½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯´ä¸€è¯´ä¸ºä»€ä¹ˆåˆšä¸Šæ¥å°±ä½¿ç”¨D3ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼Ÿ</p><p>é¦–å…ˆä½ å¾—å‚¨å¤‡å¤§é‡SVGç›¸å…³çš„çŸ¥è¯†ï¼Œä½†å¦‚æœä½ ä¹‹å‰æ²¡æ¥è§¦è¿‡SVGç»˜å›¾çš„è¯ï¼Œå°±ä¼šèŠ±å¤§é‡çš„æ—¶é—´æˆæœ¬ä¸‹å»ï¼Œ</p><p>D3ä¸»è¦æ˜¯å’ŒDOMäº¤äº’ï¼Œæ¯”å¦‚SVGæœ‰å…­å¤§é¢„è®¾å›¾å½¢ï¼šçŸ©å½¢rectã€åœ†å½¢circleã€æ¤­åœ†ellipseã€çº¿æ¡lineã€æŠ˜çº¿polylineã€å¤šè¾¹å½¢polygonï¼Œå¦å¤–å†åŠ ä¸€ä¸ªä¸‡èƒ½çš„è·¯å¾„path</p><p><img src="https://cdn.danni.cool/file/5eaa7db45657c134c696ba6d3d98aab6.png" alt="1567698476394-79dbdf0e-a87d-43e5-865c-740fe8d40518.png"></p><p>å½“ä½ å†³å®šä½¿ç”¨D3ç”»å›¾æ—¶ï¼Œä½ å°±ä¼šä¸èƒ½é¿å…çš„æ¥è§¦è¿™äº›æ ‡ç­¾çš„ç»˜å›¾å±æ€§ï¼Œç‰¹åˆ«æ˜¯å½“ä½ è¦ä½¿ç”¨è¿™ä¹ˆä¸€å †å±æ€§æ¥ç»˜å›¾çš„æ—¶å€™ï¼Œä½ è¿˜å¾—å»å­¦æ¯ä¸ªå›¾å½¢çš„å±æ€§ï¼Œé‚£çœŸçš„æ˜¯ä¼šå¢åŠ å¾ˆå¤šæ—¶é—´æˆæœ¬ã€‚å½“ç„¶ï¼ŒD3å·²ç»å¸®ä½ åšäº†å¾ˆå¤šå°è£…ï¼Œå³ä½¿è¿™æ ·æˆ‘è¿˜æ˜¯è§‰å¾—è¦äº†è§£å¤ªå¤šSVGçš„çŸ¥è¯†ï¼Œæ‰èƒ½æŠŠä¸€ä¸ªå›¾ç”»å¥½ã€‚æ¯”å¦‚æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹</p><ul><li><a href="https://segmentfault.com/a/1190000012303584">ã€ŠD3ç®€å•å…¥é—¨ã€‹</a></li><li><a href="https://www.w3schools.com/graphics/svg_path.asp">ã€Šw3cSchool - svg pathã€‹</a></li></ul><p>è¿™ä¸ªå…¶å®å°±æœ‰ç‚¹ç±»ä¼¼äºç”¨CSS3åŠ¨ç”»å»å®ç°å¤æ‚çš„H5åŠ¨ç”»ï¼Œè¿™ä¸€ç‚¹å…¶å®æˆ‘è¿˜æ˜¯å»ºè®®ä½¿ç”¨å¯è§†åŒ–çš„æ–¹å¼å»è°ƒæ•´ï¼Œä¹‹å‰é¡¹ç›®é‡Œæˆ‘åšè¿‡ä¸€ä¸ªå¸¦è·¯å¾„çš„ä½“éªŒåœ°å›¾ï¼ˆçº¢æ¡†éƒ¨åˆ†ï¼‰ï¼Œå…¶è·¯å¾„å°±æ˜¯ç›´æ¥é€šè¿‡è®¾è®¡ç¨¿sketchç”Ÿæˆçš„ï¼Œè·¯åŠ²çš„è¡Œå¾„åŠ¨æ•ˆåˆ™æ˜¯æ ¹æ®æ•°å€¼çš„ç™¾åˆ†æ¯”çš„ä½ç½®è®¡ç®—å‡ºæ¥çš„ï¼Œå…‰è¿™ä¸ªåŠ¨æ•ˆä»é¢„ç ”åˆ°å®ç°ç”¨äº†2å¤©ã€‚</p><p><img src="https://cdn.danni.cool/file/d33cbdad757b1a51ed0c6765c6afacbf.png" alt="1567738830152-8a0fd8be-f933-462d-9859-2012cae4c04a.png"></p><p>å…¶æ¬¡ï¼Œè¿˜éœ€è¦æŒæ¡ä¸€äº›ç®—æ³•å’Œæ•°å­¦å‡½æ•°ï¼Œæ¯”å¦‚è¿™æ¬¡ç”»è¿™ä¸ªåƒæŠ›ç‰©çº¿ï¼ˆåé¢ä¼šè®²ï¼‰ï¼Œç”»åœ†å¼§ï¼Œè¿™äº›SVGå›ºç„¶æœ‰å¾ˆå¤šé¢„è®¾å¯ä»¥é€‰ï¼Œä½†æ˜¯ä½ è¦è®©ä»–ä»¬åŠ¨èµ·æ¥ï¼Œå°±å¿…é¡»ä½¿ç”¨ pathï¼Œè€Œpathå‡ ä¹æ˜¯ä¸€ä¸ªç‚¹ä¸€ä¸ªç‚¹ç»˜åˆ¶çš„ï¼Œè¿™æ‰é€ å°±äº†SVGçš„æ— é™å¯èƒ½ã€‚</p><p><strong>è¿™æ˜¯æˆ‘ä¸­é€”æ”¾å¼ƒD3çš„åŸå› ã€‚</strong></p><p>å½“ç„¶ï¼Œä½¿ç”¨D3æ¯”çº¯ç”¨JSå»æ“ä½œSVGè¿˜æ˜¯æœ‰å…¶ä¼˜åŠ¿çš„ï¼Œè¿™ä¸ªåé¢å†å•ç‹¬å¼€ä¸€ç« èŠ‚è®²ã€‚</p><h1 id="ä¸‰ã€ç”¨G2æŠŠå›¾ç”»å¥½"><a href="#ä¸‰ã€ç”¨G2æŠŠå›¾ç”»å¥½" class="headerlink" title="ä¸‰ã€ç”¨G2æŠŠå›¾ç”»å¥½"></a>ä¸‰ã€ç”¨G2æŠŠå›¾ç”»å¥½</h1><h2 id="é¢ç§¯å›¾"><a href="#é¢ç§¯å›¾" class="headerlink" title="é¢ç§¯å›¾"></a>é¢ç§¯å›¾</h2><p>ä½ ä½¿ç”¨G2çš„è¯ï¼Œå…¶å®æœ‰ä¸€ç§æ‰¾å›echartçš„æ„Ÿè§‰, é€šè¿‡å®˜ç½‘å»æ‰¾ç¤ºä¾‹ï¼Œ<a href="https://antv.alipay.com/zh-cn/g2/3.x/demo/area/basic.html">é¢ç§¯å›¾</a> æ¯”è¾ƒç¬¦åˆæˆ‘ä»¬çš„è¯‰æ±‚ï¼Œé€šè¿‡ç®€å•çš„chart.line() å°±èƒ½ç»˜åˆ¶å‡ºå¹³æ»‘çš„æ›²çº¿ã€‚</p><p><img src="https://cdn.danni.cool/file/0b154b66ca3f9bbbe813876de5c7ed04.png" alt="1567747687152-fd8043b4-0e81-4e57-9a94-d22307064f5f.png"></p><p>è¿™ä¸ªå›¾çš„éš¾ç‚¹åœ¨äºä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ï¼š</p><ul><li>æ›²çº¿éƒ¨åˆ†ï¼Œå› ä¸ºè¦ç”»å‡ºç±»ä¼¼è®¾è®¡ç¨¿çš„å¹³æ»‘æ›²çº¿ï¼Œæ‰€ä»¥å°±ä¸èƒ½åªä½¿ç”¨å‡ ä¸ªç‚¹çš„æ ‡è®°ï¼Œæˆ‘ä»¬éœ€è¦ä¸€è¿ä¸²çš„åæ ‡ï¼Œè¿™æ¬¡å¾—ç›Šäºç®—æ³•ç»„çš„å¸®åŠ©ï¼Œå‘Šè¯‰æˆ‘è¿™æ˜¯ä¸€æ¡æ­£æ€åˆ†å¸ƒæ›²çº¿å›¾ã€‚</li><li>æ•°æ®éƒ¨åˆ†ï¼Œå› ä¸ºäº‹å…ˆå®šä¹‰å¥½äº†ä½¿ç”¨æ­£æ€åˆ†å¸ƒæ›²çº¿ï¼Œé‚£ä¹ˆå…·ä½“æ ‡æ³¨çš„åœ°æ–¹å°±æ˜¯ç›¸åº”çš„åæ ‡ï¼Œåç«¯ä¼ å…¥æ•°æ®çš„åŒºé—´ä¸º -2.5 ~ 2.5ï¼Œéœ€è¦å°†åæ ‡æ˜ å°„åˆ° 0 ~100 çš„å›¾ä¸­ã€‚</li></ul><h3 id="æ­£æ€åˆ†å¸ƒå‡½æ•°"><a href="#æ­£æ€åˆ†å¸ƒå‡½æ•°" class="headerlink" title="æ­£æ€åˆ†å¸ƒå‡½æ•°"></a>æ­£æ€åˆ†å¸ƒå‡½æ•°</h3><p>æˆ‘ä»¬å…ˆæ¥å›é¡¾çœ‹ä¸‹ä¸€èˆ¬æ­£æ€åˆ†å¸ƒå‡½æ•°çš„å®šä¹‰ï¼Œæœäº†å…¨ç½‘ï¼Œæ¶è¡¥äº†é«˜æ•°çš„çŸ¥è¯†ï¼Œå®ƒçš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼š</p><blockquote><p>è‹¥<a href="https://baike.baidu.com/item/%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F/828980">éšæœºå˜é‡</a>Xæœä»ä¸€ä¸ª<a href="https://baike.baidu.com/item/%E6%95%B0%E5%AD%A6%E6%9C%9F%E6%9C%9B/5362790">æ•°å­¦æœŸæœ›</a>ä¸ºÎ¼ã€<a href="https://baike.baidu.com/item/%E6%96%B9%E5%B7%AE/3108412">æ–¹å·®</a>ï¼ˆÏƒ^2ï¼‰çš„æ­£æ€åˆ†å¸ƒï¼Œè®°ä¸ºN(Î¼ï¼ŒÏƒ^2)ã€‚å…¶<a href="https://baike.baidu.com/item/%E6%A6%82%E7%8E%87%E5%AF%86%E5%BA%A6%E5%87%BD%E6%95%B0/5021996">æ¦‚ç‡å¯†åº¦å‡½æ•°</a>ä¸ºæ­£æ€åˆ†å¸ƒçš„<a href="https://baike.baidu.com/item/%E6%9C%9F%E6%9C%9B%E5%80%BC/8664642">æœŸæœ›å€¼</a>Î¼å†³å®šäº†å…¶ä½ç½®ï¼Œå…¶<a href="https://baike.baidu.com/item/%E6%A0%87%E5%87%86%E5%B7%AE/1415772">æ ‡å‡†å·®</a>Ïƒå†³å®šäº†åˆ†å¸ƒçš„å¹…åº¦ã€‚å½“Î¼ &#x3D; 0,Ïƒ &#x3D; 1æ—¶çš„æ­£æ€åˆ†å¸ƒæ˜¯<a href="https://baike.baidu.com/item/%E6%A0%87%E5%87%86%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83">æ ‡å‡†æ­£æ€åˆ†å¸ƒ</a>ã€‚</p></blockquote><p>å®ƒçš„å‡½æ•°å¤§æ¦‚é•¿è¿™æ ·</p><p><img src="https://cdn.danni.cool/file/1682c3895374d065c038a4cb23ec30e4.png" alt="1567749607066-84314abe-dd4e-4999-ae52-8138a75ebe2d.png"></p><p>ç”»åˆ°å›¾å½¢ä¸Š</p><p><strong>ä¸€èˆ¬æ­£æ€åˆ†å¸ƒå‡½æ•°</strong></p><p><img src="https://cdn.danni.cool/file/aab56c82bd2177262817055b34e2ab33.png" alt="Untitled.png"></p><p><strong>Î¼ &#x3D; 0,Ïƒ &#x3D; 1ï¼Œä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ</strong></p><p><img src="https://cdn.danni.cool/file/1643c8b622dd00aee4f87baec1d8b87a.png" alt="Untitled.png"></p><p>è¿™é‡Œæˆ‘ä»¬è¦å…³æ³¨å‡ ä¸ªå‚æ•°ï¼š</p><ol><li>1Î¼ï¼ˆå¹³å‡å€¼ï¼‰å†³å®šäº†æœ€é«˜ç‚¹çš„ä½ç½®xè½´ä¸Šçš„åç§»é‡ã€‚</li><li>2Ïƒï¼ˆæ ‡å‡†å·®ï¼‰å†³å®šäº†è¿™ä¸ªå‡½æ•°çš„é™¡å³­è¿˜æ˜¯å¹³ç¼“,Â Ïƒè¶Šå°ï¼Œå‡½æ•°è¶Šé™¡å³­</li><li>Î¼ - n*Ïƒ å¯ä»¥åˆ’å®šå‡½æ•°çš„è¾¹ç•Œ</li></ol><p><strong>æ­£æ€åˆ†å¸ƒå‡½æ•°ä½¿ç”¨JSè¡¨è¾¾ï¼š</strong></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript"> <span class="hljs-comment">// x: xçš„å€¼</span><br> <span class="hljs-comment">// mean: å¹³å‡æ•°</span><br> <span class="hljs-comment">// std: æ ‡å‡†å·®</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">lineGenerate</span>(<span class="hljs-params">x, mean, std</span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>      (<span class="hljs-number">1</span> / (std * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>))) * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">exp</span>(-(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(x - mean, <span class="hljs-number">2</span>) / (<span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(std, <span class="hljs-number">2</span>))))<br>    )<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ•°æ®æ˜ å°„</strong></p><p><img src="https://cdn.danni.cool/file/9b82b55711d867cc1bd4dfcd991365fa.png" alt="1567748640065-fc0616af-306f-4808-887f-e3d8faa8bcd3.png"></p><p>é€šè¿‡å°† -2.5 ~ 2.5 çš„æ¥å£æ•°æ®ï¼Œæ˜ å°„åˆ° 0~100 æˆ‘ä»¬é€šè¿‡æ–¹ç¨‹è®¡ç®—å¾—çŸ¥</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// x ä¸ºè¾“å…¥å€¼ </span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">scaleMap</span>(<span class="hljs-params">x</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>((<span class="hljs-number">20</span> * x) + <span class="hljs-number">50</span>)<br>  &#125;<br></code></pre></td></tr></table></figure><p><strong>å›¾ä¾‹åŠ¨æ€é«˜åº¦</strong></p><p><img src="https://cdn.danni.cool/file/07e3f0e90161bb66d9623e72d92c0136.png" alt="1567751903041-fff1eb54-a6df-4bd3-9243-6c14fedc208c.png"></p><p>å›¾ä¾‹éƒ¨åˆ†æ˜¯ä½¿ç”¨domå®ç°çš„ï¼Œè¿™éƒ¨åˆ†ç”±G2çš„ chart.guide() API æä¾›ï¼Œå®ƒçš„å®½é«˜éƒ½æ˜¯åƒç´ pxï¼Œè¿™è¾¹æˆ‘ä»¬æ²¡å®šä¹‰ç›¸åº”çš„æ•°æ®åˆ°å°ºå¯¸çš„æ¯”ä¾‹å°ºï¼Œå› ä¸ºåŸºæœ¬æ²¡ç”¨ä¸Šï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†ç¨å¾®å·äº†ä¸‹æ‡’ï¼Œæ¯•ç«Ÿåœ¨pcç«¯ä¹Ÿæ²¡æœ‰å“åº”å¼ç¼©æ”¾ï¼Œæ‰€ä»¥å°±ç»™å¯¹åº”çš„åæ ‡ä¹˜ä»¥äº†ä¸€ä¸ªç³»æ•°å»å®ç°ç±»ä¼¼çš„æ ¹æ®ä¸åŒçš„æ•°æ®å±•ç¤ºä¸åŒçš„é«˜åº¦ã€‚</p><p>htmlç‰‡æ®µï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs typescript">**<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;region&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width:23.8px;height:$&#123;lineGenerate(drawX) * adjustValue&#125;px;&quot;</span>&gt;</span>**</span><br></code></pre></td></tr></table></figure><p>javascriptç‰‡æ®µï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs typescript">**<span class="hljs-comment">//è®¡ç®—å’Œä¸­å¿ƒç‚¹çš„åç§»é‡ ï¼Œè·ç¦»ä¸­å¿ƒç‚¹çº¦è¿œï¼Œç³»æ•°è¶Šå°</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(drawX - <span class="hljs-number">50</span>) &lt; <span class="hljs-number">10</span>) &#123;<br>      adjustValue = <span class="hljs-number">16200</span><br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(drawX - <span class="hljs-number">50</span>) &lt; <span class="hljs-number">20</span>) &#123;<br>      adjustValue = <span class="hljs-number">16000</span><br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(drawX - <span class="hljs-number">50</span>) &lt; <span class="hljs-number">30</span>) &#123;<br>      adjustValue = <span class="hljs-number">15000</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      adjustValue = <span class="hljs-number">14500</span><br>    &#125;**<br></code></pre></td></tr></table></figure><p>å®Œæ•´ç¤ºä¾‹ï¼š<a href="https://codepen.io/danielchan27/pen/YzKYENw?editors=1011">codePen - areaChart</a></p><h3 id="ç¯å½¢è¿›åº¦æ¡-1"><a href="#ç¯å½¢è¿›åº¦æ¡-1" class="headerlink" title="ç¯å½¢è¿›åº¦æ¡"></a>ç¯å½¢è¿›åº¦æ¡</h3><p>è€Œç»˜åˆ¶ç¯å½¢è¿›åº¦æ¡æˆ‘å‚è€ƒäº†<a href="https://www.yuque.com/chentianyu/ykdmaz/tt8afr/edit">G2-ä»ªè¡¨ç›˜</a>ç»“æœåŠå¤©æ²¡å†™å‡ºæ¥ï¼Œä¸»è¦æ˜¯ è¿™ä¸ªä»ªè¡¨ç›˜ä½¿ç”¨äº†å–å·§çš„åŠæ³•ï¼Œå…¶å®è´¨ä¸Šè¿˜æ˜¯ä½¿ç”¨äº†chartå»åšï¼Œå¯¹åæ ‡è½´é‡‡ç”¨äº†æåæ ‡çš„å˜æ¢ï¼Œæ‰€ä»¥çœ‹ä¸Šå»åƒç¯å½¢è¿›åº¦æ¡ï¼Œæœ€éš¾å®ç°çš„å°±æ˜¯é¦–æœ«ä¸¤æ®µçš„åœ†è§’éƒ¨åˆ†ï¼Œåˆ‡å·®è·æ¯”è¾ƒå¤§ï¼Œé‚å¼ƒã€‚</p><p><img src="https://cdn.danni.cool/file/07af33a0ef37e482bfd6a5bc412f30b4.png" alt="1567754481251-27cb8214-8470-4b6e-87a7-7881ea3318a0.png"></p><h3 id="æ³¨å†Œè‡ªå®šä¹‰å›¾å½¢"><a href="#æ³¨å†Œè‡ªå®šä¹‰å›¾å½¢" class="headerlink" title="æ³¨å†Œè‡ªå®šä¹‰å›¾å½¢"></a>æ³¨å†Œè‡ªå®šä¹‰å›¾å½¢</h3><p>ä½†æ˜¯G2é™¤äº†èƒ½ç»˜åˆ¶å›¾è¡¨ä»¥ä¸ºï¼Œè¿˜é€šè¿‡äº†Shape.shapeå®ç°äº†<a href="https://www.yuque.com/antv/g2-docs/api-shape">è‡ªå®šä¹‰å›¾å½¢</a>çš„ç»˜åˆ¶ï¼Œå…·ä½“æœ‰ä»¥ä¸‹å‡ ç§</p><ul><li><strong>pointï¼š</strong>ç‚¹çš„ç»˜åˆ¶å¾ˆç®€å•ï¼Œåªè¦è·å–å®ƒçš„åæ ‡ä»¥åŠå¤§å°å³å¯ï¼Œå…¶ä¸­çš„Â sizeÂ å±æ€§ä»£è¡¨çš„æ˜¯ç‚¹çš„åŠå¾„ã€‚</li></ul><p><img src="https://cdn.danni.cool/file/aa081a50c441a0e8e054e96577defe40.png" alt="Untitled.png"></p><ul><li><strong>lineï¼š</strong>çº¿å…¶å®æ˜¯ç”±æ— æ•°ä¸ªç‚¹ç»„æˆï¼Œåœ¨ G2 ä¸­æˆ‘ä»¬å°†å‚ä¸ç»˜åˆ¶çš„å„ä¸ªæ•°æ®è½¬æ¢æˆåæ ‡ä¸Šçš„ç‚¹ç„¶åé€šè¿‡çº¿å°†é€ä¸ªç‚¹è¿æ¥è€Œæˆå½¢æˆçº¿å›¾ï¼Œå…¶ä¸­çš„Â sizeÂ å±æ€§ä»£è¡¨çš„æ˜¯çº¿çš„ç²—ç»†ã€‚</li></ul><p><img src="https://cdn.danni.cool/file/a1f4c92c27d1f371cd181d106c52ac30.png" alt="Untitled.png"></p><ul><li><strong>areaï¼š</strong>area é¢å…¶å®æ˜¯åœ¨ line çº¿çš„åŸºç¡€ä¹‹ä¸Šå½¢æˆçš„, å®ƒå°†æŠ˜çº¿å›¾ä¸­æŠ˜çº¿ä¸è‡ªå˜é‡åæ ‡è½´ä¹‹é—´çš„åŒºåŸŸä½¿ç”¨é¢œè‰²æˆ–è€…çº¹ç†å¡«å……ã€‚</li></ul><p><img src="https://cdn.danni.cool/file/405fe7f32022b39b8e880529ec88150c.png" alt="Untitled.png"></p><ul><li><strong>intervalï¼š</strong>interval é»˜è®¤çš„å›¾å½¢å½¢çŠ¶æ˜¯çŸ©å½¢ï¼Œè€ŒçŸ©å½¢å®é™…æ˜¯ç”±å››ä¸ªç‚¹ç»„æˆçš„ï¼Œåœ¨ G2 ä¸­æˆ‘ä»¬æ ¹æ® pointInfo ä¸­çš„ xã€yã€size ä»¥åŠ y0 è¿™å››ä¸ªå€¼æ¥è®¡ç®—å‡ºè¿™å››ä¸ªç‚¹ï¼Œç„¶åé¡ºæ—¶é’ˆè¿æ¥è€Œæˆã€‚</li></ul><p><img src="https://cdn.danni.cool/file/278787656dd26accc462362be0420743.png" alt="Untitled.png"></p><ul><li><strong>polygonï¼š</strong>polygon å¤šè¾¹å½¢å…¶å®ä¹Ÿæ˜¯ç”±å¤šä¸ªç‚¹è¿æ¥è€Œæˆï¼Œåœ¨ pointInfo ä¸­ x å’Œ y éƒ½æ˜¯æ•°ç»„ç»“æ„ã€‚</li></ul><p><img src="https://cdn.danni.cool/file/713883cf91082ff07ec92319eb997dfc.png" alt="Untitled.png"></p><ul><li><strong>schemaï¼š</strong>schema ä½œä¸ºä¸€ç§è‡ªå®šä¹‰çš„å‡ ä½•å›¾å½¢ï¼Œåœ¨ G2 ä¸­é»˜è®¤æä¾›äº† box å’Œ candle ä¸¤ç§ shapeï¼Œåˆ†åˆ«ç”¨äºç»˜åˆ¶ç®±å‹å›¾å’Œè‚¡ç¥¨å›¾ï¼Œæ³¨æ„è¿™ä¸¤ç§å½¢çŠ¶çš„çŸ©å½¢éƒ¨åˆ†å››ä¸ªç‚¹çš„è¿æ¥é¡ºåºéƒ½æ˜¯é¡ºæ—¶é’ˆï¼Œå¹¶ä¸”èµ·å§‹ç‚¹å‡ä¸ºå·¦ä¸‹è§’ï¼Œè¿™æ ·å°±å¯ä»¥æ— ç¼è½¬æ¢è‡³æåæ ‡ã€‚</li></ul><p><img src="https://cdn.danni.cool/file/d163a1c014adf0df93415af5f116708c.png" alt="Untitled.png"></p><ul><li><strong>edgeï¼š</strong>edge è¾¹åŒ line çº¿ä¸€è‡´ï¼ŒåŒºåˆ«å°±æ˜¯ edge æ˜¯ä¸€ä¸ªçº¿æ®µï¼Œè¿æ¥è¾¹çš„ä¸¤ä¸ªç«¯ç‚¹å³å¯ã€‚</li></ul><p>äºæ˜¯æŸ¥äº†æ‰¾éå…¨ç½‘ï¼Œæ‰¾äº†åŠå¤©æ–‡æ¡£ï¼Œç»ˆäºå‘ç°äº†åŸæ¥ G2.Shape.registerShapeÂ æ˜¯å¯ä»¥å®ç°çš„ï¼Œä½†æ˜¯æ–‡æ¡£å’Œç›¸å…³demoå°‘çš„å¯æ€œï¼Œæ¥ä¸‹æ¥çš„ç”»å›¾çœŸçš„æ˜¯ç¡¬æ ¸å†™å®Œçš„ã€‚</p><ol><li><strong>å®šä¹‰å¸¦æœ‰åœ†è§’çš„5pxçš„çº¿çš„é¢„è®¾</strong></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Shape</span> = <span class="hljs-variable constant_">G2</span>.<span class="hljs-property">Shape</span> <span class="hljs-comment">// ç¯å½¢å›¾è‡ªå®šä¹‰å½¢çŠ¶</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Animate</span> = <span class="hljs-variable constant_">G2</span>.<span class="hljs-property">Animate</span><br><br>   <span class="hljs-title class_">Shape</span>.<span class="hljs-title function_">registerShape</span>(<span class="hljs-string">&#x27;edge&#x27;</span>, <span class="hljs-string">&#x27;arc2&#x27;</span>, &#123;<br>     <span class="hljs-attr">draw</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">draw</span>(<span class="hljs-params">cfg, group</span>) &#123;<br><br><span class="hljs-comment">// å°†0-1ç©ºé—´çš„åæ ‡è½¬æ¢ä¸ºç”»å¸ƒåæ ‡ï¼Œthis.parsePoint çœŸçš„å¤ªå®è´µäº†ï¼Œä¸€èˆ¬äººæ‰¾ä¸åˆ°ä»–</span><br>       <span class="hljs-keyword">const</span> center = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">parsePoint</span>(&#123; <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> &#125;)<br><br><span class="hljs-comment">// ç®—å‡ºåœ†çš„æœ€å¤§åŠå¾„</span><br>       <span class="hljs-keyword">const</span> R = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">parsePoint</span>(&#123; <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">1</span> &#125;).<span class="hljs-property">y</span> - center.<span class="hljs-property">y</span><br>       <span class="hljs-keyword">const</span> lineWidth = <span class="hljs-number">5</span><br><br>       <span class="hljs-comment">//è¿™è¾¹å®šä¹‰é¢„è®¾</span><br>       <span class="hljs-keyword">return</span> group.<span class="hljs-title function_">addShape</span>(<span class="hljs-string">&#x27;arc&#x27;</span>, &#123;<br>         <span class="hljs-attr">attrs</span>: &#123;<br>           <span class="hljs-attr">x</span>: center.<span class="hljs-property">x</span>,<br>           <span class="hljs-attr">y</span>: center.<span class="hljs-property">y</span>,<br>           <span class="hljs-attr">r</span>: (R + lineWidth),<br>           <span class="hljs-attr">startAngle</span>: (<span class="hljs-number">3</span> / <span class="hljs-number">4</span>) * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,<br>           <span class="hljs-attr">endAngle</span>: (<span class="hljs-number">1</span> / <span class="hljs-number">4</span>) * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,<br>           <span class="hljs-attr">stroke</span>: <span class="hljs-string">&#x27;#8B5EFF&#x27;</span>,<br>           lineWidth,<br>           <span class="hljs-attr">lineCap</span>: <span class="hljs-string">&#x27;round&#x27;</span><br>         &#125;<br>       &#125;)<br>     &#125;<br>   &#125;)<br></code></pre></td></tr></table></figure><ol><li><strong>æ–°èµ·ä¸€ä¸ªchartï¼Œä½¿ç”¨æåæ ‡å˜æ¢</strong></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> chart = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">G2</span>.<span class="hljs-title class_">Chart</span>(&#123;<br>  <span class="hljs-attr">container</span>: wrapEl,<br>  <span class="hljs-attr">forceFit</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">height</span>: <span class="hljs-number">60</span>,<br>  <span class="hljs-attr">padding</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br>&#125;)<br><br>chart.<span class="hljs-title function_">source</span>(data)<br><br>chart.<span class="hljs-title function_">coord</span>(<span class="hljs-string">&#x27;polar&#x27;</span>, &#123;<br>  <span class="hljs-attr">startAngle</span>: (<span class="hljs-number">3</span> / <span class="hljs-number">4</span>) * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,<br>  <span class="hljs-attr">endAngle</span>: (<span class="hljs-number">1</span> / <span class="hljs-number">4</span>) * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,<br>  <span class="hljs-attr">radius</span>: <span class="hljs-number">0.85</span><br>&#125;)<br></code></pre></td></tr></table></figure><ol><li><strong>ç»˜åˆ¶ç°è‰²åœ†å¼§èƒŒæ™¯</strong></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript">chart.<span class="hljs-title function_">guide</span>().<span class="hljs-title function_">arc</span>(&#123;<br>  <span class="hljs-attr">zIndex</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">top</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">start</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0.945</span>],<br>  <span class="hljs-attr">end</span>: [<span class="hljs-number">100</span>, <span class="hljs-number">0.945</span>],<br>  <span class="hljs-attr">style</span>: &#123;<br>    <span class="hljs-comment">// åº•ç°è‰²</span><br>    <span class="hljs-attr">stroke</span>: <span class="hljs-string">&#x27;#E5E5E5&#x27;</span>,<br>    <span class="hljs-attr">lineWidth</span>: <span class="hljs-title class_">Piechart</span>.<span class="hljs-property">lineWidth</span>,<br>    <span class="hljs-attr">lineCap</span>: <span class="hljs-string">&#x27;round&#x27;</span><br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><ol><li><strong>ç»˜åˆ¶æ˜¾ç¤ºçš„è¿›åº¦æ¡å¹¶æŒ‡å®šåŠ¨ç”»åç§°</strong></li></ol><p>è¿™è¾¹æœ‰ç‚¹å‘ï¼Œæˆ‘ä»¬å‘ç°åŠ¨ç”»æ‰§è¡Œè¿‡ç¨‹ä¸­åªæœ‰åŠ¨ç”»å®Œæˆæ—¶çš„callbackï¼Œè€ŒantVåŒæ¬¾å¯è§†åŒ–ç»„ä»¶ï¼Œ<a href="https://antv.alipay.com/zh-cn/f2/3.x/demo/gallery/simple-gauge.html">F2</a>åˆ™æä¾›äº†update()çš„å›è°ƒï¼Œè¿™æ„å‘³ç€å¢é•¿çš„åŠ¨ç”»æ•ˆæœéœ€è¦æˆ‘ä»¬è‡ªå·±åšã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript">chart<br>    .<span class="hljs-title function_">edge</span>()<br>    .<span class="hljs-title function_">shape</span>(<span class="hljs-string">&#x27;arc2&#x27;</span>)<br>    .<span class="hljs-title function_">position</span>(<span class="hljs-string">&#x27;value*1&#x27;</span>)<br>    .<span class="hljs-title function_">animate</span>(&#123;<br>      <span class="hljs-attr">appear</span>: &#123;<br>        <span class="hljs-attr">animation</span>: <span class="hljs-string">&#x27;stepPercent&#x27;</span>, <span class="hljs-comment">// åŠ¨ç”»åç§°</span><br>        <span class="hljs-attr">easing</span>: <span class="hljs-string">&#x27;easeQuadInOut&#x27;</span>, <span class="hljs-comment">// åŠ¨ç”»ç¼“åŠ¨æ•ˆæœ</span><br>        <span class="hljs-attr">delay</span>: <span class="hljs-number">100</span>, <span class="hljs-comment">// åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œæ—¶é—´</span><br>        <span class="hljs-attr">duration</span>: <span class="hljs-number">1000</span>, <span class="hljs-comment">// åŠ¨ç”»æ‰§è¡Œæ—¶é—´</span><br>        <span class="hljs-title function_">callback</span>(<span class="hljs-params"></span>) &#123;<br>          <span class="hljs-comment">// console.log(&#x27;åŠ¨ç”»ç»“æŸ&#x27;)</span><br>        &#125;<br>      &#125;<br>    &#125;)<br>    .<span class="hljs-title function_">active</span>(<span class="hljs-literal">false</span>)<br>    .<span class="hljs-title function_">select</span>(<span class="hljs-literal">false</span>)<br></code></pre></td></tr></table></figure><ol><li><strong>æ³¨å†Œä¸€ä¸ªå¢é•¿åŠ¨ç”»æ•ˆæœçš„å¼€å§‹çŠ¶æ€å’Œç»“æŸçŠ¶æ€</strong></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// æ³¨å†Œç™¾åˆ†æ¯”åŠ¨ç”»</span><br><span class="hljs-title class_">Animate</span>.<span class="hljs-title function_">registerAnimation</span>(<span class="hljs-string">&#x27;appear&#x27;</span>, <span class="hljs-string">&#x27;stepPercent&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">shape, animateCfg</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> startAngle = shape.<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;startAngle&#x27;</span>)<br><br>  <span class="hljs-comment">// è®¾ç½®åˆå§‹çŠ¶æ€</span><br>  shape.<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;endAngle&#x27;</span>, (-<span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>) + startAngle)<br><br>  <span class="hljs-keyword">const</span> endX = shape.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;origin&#x27;</span>).<span class="hljs-property">points</span>[<span class="hljs-number">0</span>].<span class="hljs-property">x</span><br>  shape.<span class="hljs-title function_">animate</span>(<br>    &#123;<br>      <span class="hljs-attr">endAngle</span>: ((<span class="hljs-number">3</span> / <span class="hljs-number">2</span>) * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * endX) - ((<span class="hljs-number">5</span> / <span class="hljs-number">4</span>) * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>)<br>    &#125;,<br>    animateCfg.<span class="hljs-property">duration</span>,<br>    animateCfg.<span class="hljs-property">easing</span>,<br>    animateCfg.<span class="hljs-property">callback</span>,<br>    animateCfg.<span class="hljs-property">delay</span><br>  )<br><br>  <span class="hljs-comment">//   console.log(&#x27;å¼€å§‹åšåŠ¨ç”»&#x27;)</span><br>  $number = $(<span class="hljs-string">`#number-<span class="hljs-subst">$&#123;wrapEl&#125;</span>`</span>)<br>  <span class="hljs-title function_">gainPercent</span>()<br><br>&#125;)<br></code></pre></td></tr></table></figure><ol><li><strong>requestAnimationFrameæ³¨å†Œçš„æ­¥è¿›åŠ¨ç”»</strong></li></ol><p>å› ä¸ºç”µè„‘ç¼˜æ•…ï¼Œæ€§èƒ½ä½ä¸‹çš„CPUå¯èƒ½åœ¨1ç§’å†…æ‰§è¡Œä¸å®Œ60å¸§ï¼Œæ‰€ä»¥ä½¿ç”¨<strong>requestAnimationFrame</strong>ï¼Œå¦å¤–å› ä¸ºÂ data[0].value &#x2F; 60Â æ˜¯ä¸ªä¸ç²¾å‡†çš„æ•°å€¼ï¼Œæ‰€ä»¥ä¼šå‡ºç°æœ€åç´¯åŠ å‡ºç°ä¸ç­‰äºä¼ å…¥å€¼çš„æƒ…å†µï¼Œåœ¨æœ€åä¸€ä¸ªæ¬¡ç´¯åŠ ç­‰äºæ­£å¸¸å€¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> $number<br><span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span><br><span class="hljs-keyword">const</span> gainPercent = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  i++<br>  <span class="hljs-comment">// æ‰§è¡Œåˆ°æœ€åä¸€æ­¥å¼ºåˆ¶æ‹‰åˆ°ä¼ å…¥çš„æœ€ç»ˆå€¼</span><br>  <span class="hljs-keyword">if</span> (i === <span class="hljs-number">60</span>) &#123;<br>    $number.<span class="hljs-title function_">text</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;data[<span class="hljs-number">0</span>].value&#125;</span>%`</span>)<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">const</span> step = data[<span class="hljs-number">0</span>].<span class="hljs-property">value</span> / <span class="hljs-number">60</span><br>    <span class="hljs-keyword">const</span> value = $number.<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;data-val&#x27;</span>)<br>    $number.<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;data-val&#x27;</span>, +value + step)<br>    $number.<span class="hljs-title function_">text</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;(+value + step).toString().split(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">0</span>]&#125;</span>%`</span>)<br>  &#125;<br><br>  <span class="hljs-comment">// console.log(`åŠ¨ç”»æ‰§è¡Œ$&#123;i&#125;`, $number.attr(&#x27;data-val&#x27;))</span><br><br>  <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">60</span>) &#123;<br>    <span class="hljs-title function_">requestAnimationFrame</span>(gainPercent)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®Œæ•´ç¤ºä¾‹ï¼š<a href="https://codepen.io/danielchan27/pen/zYOppMZ">G2-Circle</a></p><h1 id="å››ã€åè®°"><a href="#å››ã€åè®°" class="headerlink" title="å››ã€åè®°"></a>å››ã€åè®°</h1><ol><li>é€‰æ‹©å¯è§†åŒ–æ¡†æ¶æ—¶æŒ‰å®ç°çš„ç®€å•ç¨‹åº¦ï¼šechart &gt; G2 &gt; D3 &gt; åŸç”Ÿ</li><li>echartå¤§è€Œå…¨ï¼Œä½†æ˜¯å®šåˆ¶èƒ½åŠ›æ¯”è¾ƒå¼±</li><li>G2é€‚åˆå®ç°ä¸€äº›æœ¬èº«å°±æœ‰çš„å›¾è¡¨åº“ï¼Œå•ç‹¬å»å®šä¹‰è‡ªå®šä¹‰å›¾å½¢APIå’Œæ–‡æ¡£è¾ƒå°‘</li><li>G2çš„åŠ¨ç”»å’Œè”åŠ¨èƒ½åŠ›è¾ƒå¼±ï¼Œæ¨èF2</li></ol>]]></content>
    
    
    <categories>
      
      <category>Tech</category>
      
    </categories>
    
    
    <tags>
      
      <tag>G2</tag>
      
      <tag>Canvas</tag>
      
      <tag>SVG</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
